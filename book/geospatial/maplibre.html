
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>16. MapLibre &#8212; Introduction to GIS Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/geospatial/maplibre';</script>
    <link rel="canonical" href="https://geog-312.gishub.org/book/geospatial/maplibre.html" />
    <link rel="icon" href="../../_static/fav.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="17. Geemap" href="geemap.html" />
    <link rel="prev" title="15. Whitebox" href="whitebox.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Introduction to GIS Programming - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Introduction to GIS Programming - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about/instructor.html">Instructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/schedule.html">Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/textbooks.html">Textbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/videos.html">Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/acknowledgments.html">Acknowledgments</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../software/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/miniconda.html">Miniconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/vscode.html">Visual Studio Code</a></li>

<li class="toctree-l1"><a class="reference internal" href="../software/git.html">Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/colab.html">Google Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/jupyterlab.html">JupyterLab</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../python/01_get_started.html">1. Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/02_variables.html">2. Variables and Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/03_data_structures.html">3. Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/04_string_operations.html">4. String Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/05_looping.html">5. Looping and Control Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/06_functions_classes.html">6. Functions and Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/07_files.html">7. Files and Exception Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/08_numpy_pandas.html">8. Intro to NumPy and Pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GeoPython</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="get_started.html">9. Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="geopandas.html">10. GeoPandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="rasterio.html">11. Rasterio</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray.html">12. Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="rioxarray.html">13. Rioxarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="leafmap.html">14. Leafmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="whitebox.html">15. Whitebox</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">16. MapLibre</a></li>
<li class="toctree-l1"><a class="reference internal" href="geemap.html">17. Geemap</a></li>
<li class="toctree-l1"><a class="reference internal" href="samgeo.html">18. SAMGeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypercoast.html">19. HyperCoast</a></li>
<li class="toctree-l1"><a class="reference internal" href="duckdb.html">20. DuckDB</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../labs/instructions.html">Submission Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_01.html">Lab 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_02.html">Lab 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_03.html">Lab 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_04.html">Lab 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_05.html">Lab 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_06.html">Lab 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lab_07.html">Lab 7</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/giswqs/geog-312/main?urlpath=tree/book/geospatial/maplibre.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/giswqs/geog-312/blob/main/book/geospatial/maplibre.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/giswqs/geog-312" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/giswqs/geog-312/edit/main/book/geospatial/maplibre.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/giswqs/geog-312/issues/new?title=Issue%20on%20page%20%2Fbook/geospatial/maplibre.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/book/geospatial/maplibre.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MapLibre</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">16.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes">16.2. Learning Outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-resources">16.3. Useful Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-and-setup">16.4. Installation and Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-interactive-maps">16.5. Creating Interactive Maps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-map-setup">16.5.1. Basic Map Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-map-s-center-and-zoom-level">16.5.2. Customizing the Map’s Center and Zoom Level</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-basemap-style">16.5.3. Choosing a Basemap Style</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-background-colors">16.5.4. Adding Background Colors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-map-controls">16.6. Adding Map Controls</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-controls">16.6.1. Available Controls</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-geolocate-control">16.6.2. Adding Geolocate Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-fullscreen-control">16.6.3. Adding Fullscreen Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-navigation-control">16.6.4. Adding Navigation Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-draw-control">16.6.5. Adding Draw Control</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-layers">16.7. Adding Layers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-basemaps">16.7.1. Adding Basemaps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-xyz-tile-layer">16.7.2. Adding XYZ Tile Layer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-wms-layer">16.7.3. Adding WMS Layer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-raster-tiles">16.7.4. Adding Raster Tiles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maptiler">16.8. MapTiler</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-vector-tile-source">16.8.1. Adding a vector tile source</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-mapping">16.9. 3D Mapping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-terrain">16.9.1. 3D Terrain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-buildings">16.9.2. 3D Buildings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-indoor-mapping">16.9.3. 3D Indoor Mapping</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-choropleth-map">16.9.4. 3D Choropleth Map</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-vector-data">16.10. Visualizing Vector Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#point-data">16.10.1. Point Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-marker-icon-image">16.10.2. Customizing Marker Icon Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-data">16.10.3. Line Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polygon-data">16.10.4. Polygon Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-geometries">16.10.5. Multiple Geometries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#marker-cluster">16.10.6. Marker Cluster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-vector-data">16.10.7. Local Vector Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-building-color">16.10.8. Changing Building Color</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-new-layer-below-labels">16.10.9. Adding a New Layer Below Labels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-map">16.10.10. Heat Map</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-population-density">16.10.11. Visualizing Population Density</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-raster-data">16.11. Visualizing Raster Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-raster-data">16.11.1. Local Raster Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cloud-optimized-geotiff-cog">16.11.2. Cloud Optimized GeoTIFF (COG)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stac-layer">16.11.3. STAC Layer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interacting-with-the-map">16.12. Interacting with the Map</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-a-non-interactive-map">16.12.1. Displaying a Non-Interactive Map</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disabling-scroll-zoom">16.12.2. Disabling Scroll Zoom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-bounds">16.12.3. Fitting Bounds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restricting-map-panning-to-an-area">16.12.4. Restricting Map Panning to an Area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flying-to">16.12.5. Flying To</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumping-to-a-series-of-locations">16.12.6. Jumping to a Series of Locations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-coordinates-of-the-mouse-pointer">16.12.7. Getting Coordinates of the Mouse Pointer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-layer-styles">16.13. Customizing Layer Styles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-layer-color">16.13.1. Changing Layer Color</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-case-of-labels">16.13.2. Changing Case of Labels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-label-placement">16.13.3. Variable Label Placement</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-custom-components">16.14. Adding Custom Components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-image">16.14.1. Adding Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-text">16.14.2. Adding Text</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-gif">16.14.3. Adding GIF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-html">16.14.4. Adding HTML</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-color-bar">16.14.5. Adding Color bar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-legend">16.14.6. Adding Legend</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-video">16.14.7. Adding Video</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pmtiles">16.15. PMTiles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#protomaps-sample-data">16.15.1. Protomaps Sample Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-cooperative-data">16.15.2. Source Cooperative Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-pmtiles">16.15.3. 3D PMTiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">16.15.4. 3D Buildings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-buildings-transportation-and-other-themes">16.15.5. 2D Buildings, Transportation, and Other Themes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deck-gl-layers">16.16. Deck.GL Layers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-deck-gl-layer">16.16.1. Single Deck.GL Layer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-deck-gl-layers">16.16.2. Multiple Deck.GL Layers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#google-earth-engine">16.17. Google Earth Engine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animations">16.18. Animations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-a-line">16.18.1. Animating a Line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-the-map-camera-around-a-point">16.18.2. Animating the Map Camera Around a Point</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-a-point">16.18.3. Animating a Point</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-a-point-along-a-route">16.18.4. Animating a Point Along a Route</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-a-feature-in-real-time">16.18.5. Updating a Feature in Real-Time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-html">16.19. To HTML</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">16.20. Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="maplibre">
<h1><span class="section-number">16. </span>MapLibre<a class="headerlink" href="#maplibre" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/giswqs/geog-312/blob/main/book/geospatial/maplibre.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="overview">
<h2><span class="section-number">16.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This lecture introduces the <a class="reference external" href="https://github.com/eodaGmbH/py-maplibregl">MapLibre</a> mapping backend in the Leafmap library—a powerful open-source Python tool for creating customizable 2D and 3D interactive maps. With MapLibre, GIS professionals can develop tailored visualizations that enhance data presentation and geospatial analysis. The provided Jupyter notebook demonstrates foundational skills, including interactive map creation, basemap customization, and data layer integration. Additionally, advanced features such as 3D building visualizations and dynamic map controls equip students with practical skills for effective geospatial data visualization and analysis.</p>
</section>
<section id="learning-outcomes">
<h2><span class="section-number">16.2. </span>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Link to this heading">#</a></h2>
<p>By the end of this lecture, students will be able to:</p>
<ol class="arabic simple">
<li><p><strong>Set up and install MapLibre</strong> for Python-based geospatial visualization.</p></li>
<li><p><strong>Create interactive maps</strong> and apply various basemap styles.</p></li>
<li><p><strong>Customize map elements</strong>, including markers, lines, polygons, and interactive controls.</p></li>
<li><p><strong>Explore advanced features</strong> like 3D building models and choropleth maps.</p></li>
<li><p><strong>Integrate and manage multiple data layers</strong>, such as GeoJSON, raster, and vector formats.</p></li>
<li><p><strong>Export interactive maps</strong> as standalone HTML files for easy sharing and web deployment.</p></li>
</ol>
</section>
<section id="useful-resources">
<h2><span class="section-number">16.3. </span>Useful Resources<a class="headerlink" href="#useful-resources" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://maplibre.org/maplibre-gl-js/docs">MapLibre GL JS Documentation</a>: Comprehensive documentation for MapLibre GL JS.</p></li>
<li><p><a class="reference external" href="https://github.com/eoda-dev/py-maplibregl">MapLibre Python Bindings</a>: Information on using MapLibre with Python.</p></li>
<li><p><a class="reference external" href="https://leafmap.org/maplibre/overview">MapLibre in Leafmap</a>: Examples and tutorials for MapLibre in Leafmap.</p></li>
<li><p><a class="reference external" href="https://bit.ly/maplibre">Video Tutorials</a>: Video guides for practical MapLibre skills.</p></li>
<li><p><a class="reference external" href="https://maps.gishub.org">MapLibre Demos</a>: Interactive demos showcasing MapLibre’s capabilities.</p></li>
</ul>
</section>
<section id="installation-and-setup">
<h2><span class="section-number">16.4. </span>Installation and Setup<a class="headerlink" href="#installation-and-setup" title="Link to this heading">#</a></h2>
<p>To install the required packages, uncomment and run the line below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %pip install -U &quot;leafmap[maplibre]&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Once installed, import the <code class="docutils literal notranslate"><span class="pre">maplibregl</span></code> backend from the <code class="docutils literal notranslate"><span class="pre">leafmap</span></code> package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">leafmap.maplibregl</span> <span class="k">as</span> <span class="nn">leafmap</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-interactive-maps">
<h2><span class="section-number">16.5. </span>Creating Interactive Maps<a class="headerlink" href="#creating-interactive-maps" title="Link to this heading">#</a></h2>
<section id="basic-map-setup">
<h3><span class="section-number">16.5.1. </span>Basic Map Setup<a class="headerlink" href="#basic-map-setup" title="Link to this heading">#</a></h3>
<p>Let’s start by creating a simple interactive map with default settings. This basic setup provides simple map with the <code class="docutils literal notranslate"><span class="pre">dark-matter</span></code> style on which you can add data layers, controls, and other customizations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="customizing-the-map-s-center-and-zoom-level">
<h3><span class="section-number">16.5.2. </span>Customizing the Map’s Center and Zoom Level<a class="headerlink" href="#customizing-the-map-s-center-and-zoom-level" title="Link to this heading">#</a></h3>
<p>You can specify the map’s center (latitude and longitude), zoom level, pitch, and bearing for a more focused view. These parameters help direct the user’s attention to specific areas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Hold down the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key. Click and drag to pan the map.</p>
</section>
<section id="choosing-a-basemap-style">
<h3><span class="section-number">16.5.3. </span>Choosing a Basemap Style<a class="headerlink" href="#choosing-a-basemap-style" title="Link to this heading">#</a></h3>
<p>MapLibre supports several pre-defined basemap styles such as <code class="docutils literal notranslate"><span class="pre">dark-matter</span></code>, <code class="docutils literal notranslate"><span class="pre">positron</span></code>, <code class="docutils literal notranslate"><span class="pre">voyager</span></code>, <code class="docutils literal notranslate"><span class="pre">liberty</span></code>, <code class="docutils literal notranslate"><span class="pre">demotiles</span></code>. You can also use custom basemap URLs for unique styling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://openfreemap.org">OpenFreeMap</a> provides a variety of basemap styles that you can use in your interactive maps. These styles include <code class="docutils literal notranslate"><span class="pre">liberty</span></code>, <code class="docutils literal notranslate"><span class="pre">bright</span></code>, and <code class="docutils literal notranslate"><span class="pre">positron</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-background-colors">
<h3><span class="section-number">16.5.4. </span>Adding Background Colors<a class="headerlink" href="#adding-background-colors" title="Link to this heading">#</a></h3>
<p>Background color styles, such as <code class="docutils literal notranslate"><span class="pre">background-lightgray</span></code> and <code class="docutils literal notranslate"><span class="pre">background-green</span></code>, are helpful for simple or thematic maps where color-coding is needed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;background-lightgray&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Alternatively, you can provide a URL to a vector style.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;https://demotiles.maplibre.org/style.json&quot;</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="adding-map-controls">
<h2><span class="section-number">16.6. </span>Adding Map Controls<a class="headerlink" href="#adding-map-controls" title="Link to this heading">#</a></h2>
<p>Map controls enhance the usability of the map by allowing users to interact in various ways, adding elements like scale bars, zoom tools, and drawing options.</p>
<section id="available-controls">
<h3><span class="section-number">16.6.1. </span>Available Controls<a class="headerlink" href="#available-controls" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Geolocate</strong>: Centers the map based on the user’s current location, if available.</p></li>
<li><p><strong>Fullscreen</strong>: Expands the map to a full-screen view for better focus.</p></li>
<li><p><strong>Navigation</strong>: Provides zoom controls and a compass for reorientation.</p></li>
<li><p><strong>Draw</strong>: Allows users to draw and edit shapes on the map.</p></li>
</ul>
</section>
<section id="adding-geolocate-control">
<h3><span class="section-number">16.6.2. </span>Adding Geolocate Control<a class="headerlink" href="#adding-geolocate-control" title="Link to this heading">#</a></h3>
<p>The Geolocate control centers the map based on the user’s current location, a helpful feature for location-based applications.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="s2">&quot;geolocate&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;top-left&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-fullscreen-control">
<h3><span class="section-number">16.6.3. </span>Adding Fullscreen Control<a class="headerlink" href="#adding-fullscreen-control" title="Link to this heading">#</a></h3>
<p>Fullscreen control enables users to expand the map to full screen, enhancing focus and visual clarity. This is especially useful when viewing complex or large datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">11.255</span><span class="p">,</span> <span class="mf">43.77</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="p">{})</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="s2">&quot;fullscreen&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;top-right&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-navigation-control">
<h3><span class="section-number">16.6.4. </span>Adding Navigation Control<a class="headerlink" href="#adding-navigation-control" title="Link to this heading">#</a></h3>
<p>The Navigation control provides buttons for zooming and reorienting the map, improving the user’s ability to navigate efficiently.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">11.255</span><span class="p">,</span> <span class="mf">43.77</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="p">{})</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_control</span><span class="p">(</span><span class="s2">&quot;navigation&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;top-left&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-draw-control">
<h3><span class="section-number">16.6.5. </span>Adding Draw Control<a class="headerlink" href="#adding-draw-control" title="Link to this heading">#</a></h3>
<p>The Draw control enables users to interact with the map by adding shapes such as points, lines, and polygons. This control is essential for tasks requiring spatial data input directly on the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_draw_control</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;top-left&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>You can configure the Draw control to activate specific tools, like polygon, line, or point drawing, while also enabling or disabling a “trash” button to remove unwanted shapes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">maplibre.plugins</span> <span class="kn">import</span> <span class="n">MapboxDrawControls</span><span class="p">,</span> <span class="n">MapboxDrawOptions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">draw_options</span> <span class="o">=</span> <span class="n">MapboxDrawOptions</span><span class="p">(</span>
    <span class="n">display_controls_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">controls</span><span class="o">=</span><span class="n">MapboxDrawControls</span><span class="p">(</span><span class="n">polygon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trash</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_draw_control</span><span class="p">(</span><span class="n">draw_options</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Additionally, you can load a GeoJSON FeatureCollection into the Draw control, which will allow users to view, edit, or interact with pre-defined geographical features, such as boundaries or points of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">119.08</span><span class="p">,</span> <span class="mf">45.95</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">119.79</span><span class="p">,</span> <span class="mf">42.08</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">107.28</span><span class="p">,</span> <span class="mf">41.43</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">108.15</span><span class="p">,</span> <span class="mf">46.44</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">119.08</span><span class="p">,</span> <span class="mf">45.95</span><span class="p">],</span>
                    <span class="p">]</span>
                <span class="p">],</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">103.87</span><span class="p">,</span> <span class="mf">38.08</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">108.54</span><span class="p">,</span> <span class="mf">36.44</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">106.25</span><span class="p">,</span> <span class="mf">33.00</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">99.91</span><span class="p">,</span> <span class="mf">31.79</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">96.82</span><span class="p">,</span> <span class="mf">35.48</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">98.80</span><span class="p">,</span> <span class="mf">37.77</span><span class="p">],</span>
                        <span class="p">[</span><span class="o">-</span><span class="mf">103.87</span><span class="p">,</span> <span class="mf">38.08</span><span class="p">],</span>
                    <span class="p">]</span>
                <span class="p">],</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_draw_control</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s2">&quot;top-left&quot;</span><span class="p">,</span> <span class="n">geojson</span><span class="o">=</span><span class="n">geojson</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/w8UFssd.png" /></p>
<p>Two key methods for accessing drawn features:</p>
<ul class="simple">
<li><p><strong>Selected Features</strong>: Accesses only the currently selected features.</p></li>
<li><p><strong>All Features</strong>: Accesses all features added, regardless of selection, giving you full control over the spatial data on the map.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">draw_features_selected</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">draw_feature_collection_all</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="adding-layers">
<h2><span class="section-number">16.7. </span>Adding Layers<a class="headerlink" href="#adding-layers" title="Link to this heading">#</a></h2>
<p>Adding layers to a map enhances the data it presents, allowing different types of basemaps, tile layers, and thematic overlays to be combined for in-depth analysis.</p>
<section id="adding-basemaps">
<h3><span class="section-number">16.7.1. </span>Adding Basemaps<a class="headerlink" href="#adding-basemaps" title="Link to this heading">#</a></h3>
<p>Basemaps provide a geographical context for the map. Using the <code class="docutils literal notranslate"><span class="pre">add_basemap</span></code> method, you can select from various basemaps, including <code class="docutils literal notranslate"><span class="pre">OpenTopoMap</span></code> and <code class="docutils literal notranslate"><span class="pre">Esri.WorldImagery</span></code>. Adding a layer control allows users to switch between multiple basemaps interactively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;OpenTopoMap&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can also add basemaps interactively, which provides flexibility for selecting the best background for your map content.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-xyz-tile-layer">
<h3><span class="section-number">16.7.2. </span>Adding XYZ Tile Layer<a class="headerlink" href="#adding-xyz-tile-layer" title="Link to this heading">#</a></h3>
<p>XYZ tile layers allow integration of specific tile services like topographic, satellite, or other thematic imagery from XYZ tile servers. By specifying the URL and parameters such as <code class="docutils literal notranslate"><span class="pre">opacity</span></code> and <code class="docutils literal notranslate"><span class="pre">visibility</span></code>, XYZ layers can be customized and styled to fit the needs of your map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_tile_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;USGS TOpo&quot;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;USGS&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-wms-layer">
<h3><span class="section-number">16.7.3. </span>Adding WMS Layer<a class="headerlink" href="#adding-wms-layer" title="Link to this heading">#</a></h3>
<p>Web Map Service (WMS) layers provide access to external datasets served by web servers, such as thematic maps or detailed satellite imagery. Adding a WMS layer involves specifying the WMS URL and layer names, which allows for overlaying various data types such as natural imagery or land cover classifications.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.5447</span><span class="p">,</span> <span class="mf">40.6892</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://img.nj.gov/imagerywms/Natural2015&quot;</span>
<span class="n">layers</span> <span class="o">=</span> <span class="s2">&quot;Natural2015&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">before_id</span><span class="o">=</span><span class="s2">&quot;aeroway_fill&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">100.307965</span><span class="p">,</span> <span class="mf">46.98692</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://fwspublicservices.wim.usgs.gov/wetlandsmapservice/services/Wetlands/MapServer/WMSServer&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NWI&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s2">&quot;NWI&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Wetland Type&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-raster-tiles">
<h3><span class="section-number">16.7.4. </span>Adding Raster Tiles<a class="headerlink" href="#adding-raster-tiles" title="Link to this heading">#</a></h3>
<p>Raster tiles provide a set of customized styles for map layers, such as watercolor or artistic styles, which can add unique visual elements. Configuring raster tile styles involves setting tile URLs, tile size, and attribution information. This setup provides access to a wide array of predefined designs, offering creative flexibility in how data is presented.</p>
<p>With raster tiles, you can control zoom limits and apply unique visual IDs to distinguish between multiple raster sources on the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;raster-tiles&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;raster&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tiles&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;https://tiles.stadiamaps.com/tiles/stamen_watercolor/</span><span class="si">{z}</span><span class="s2">/</span><span class="si">{x}</span><span class="s2">/</span><span class="si">{y}</span><span class="s2">.jpg&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;tileSize&quot;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;Map tiles by Stamen Design; Hosting by Stadia Maps. Data © OpenStreetMap contributors&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;simple-tiles&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;raster&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;raster-tiles&quot;</span><span class="p">,</span>
            <span class="s2">&quot;minzoom&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;maxzoom&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="maptiler">
<h2><span class="section-number">16.8. </span>MapTiler<a class="headerlink" href="#maptiler" title="Link to this heading">#</a></h2>
<p>To use MapTiler with this notebook, you need to set up a MapTiler API key. You can obtain a free API key by signing up at <a class="reference external" href="https://cloud.maptiler.com">https://cloud.maptiler.com/</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import os</span>
<span class="c1"># os.environ[&quot;MAPTILER_KEY&quot;] = &quot;YOUR_API_KEY&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Set the API key as an environment variable to access MapTiler’s resources. Once set up, you can specify any named style from MapTiler by using the style parameter in the map setup.</p>
<p><img alt="" src="https://i.imgur.com/dp2HxR2.png" /></p>
<p>The following are examples of different styles available through MapTiler:</p>
<ul class="simple">
<li><p><strong>Streets style</strong>: This style displays detailed street information and is suited for urban data visualization.</p></li>
<li><p><strong>Satellite style</strong>: Provides high-resolution satellite imagery for various locations.</p></li>
<li><p><strong>Hybrid style</strong>: Combines satellite imagery with labels for a clear geographic context.</p></li>
<li><p><strong>Topo style</strong>: A topographic map showing terrain details, ideal for outdoor-related applications.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;hybrid&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;topo&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<section id="adding-a-vector-tile-source">
<h3><span class="section-number">16.8.1. </span>Adding a vector tile source<a class="headerlink" href="#adding-a-vector-tile-source" title="Link to this heading">#</a></h3>
<p>To include vector data from MapTiler, first obtain the MapTiler API key and then set up a vector source with the desired tile data URL. The vector tile source can then be added to a layer to display features such as contour lines, which are styled for better visibility and engagement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MAPTILER_KEY</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">get_api_key</span><span class="p">(</span><span class="s2">&quot;MAPTILER_KEY&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.447303</span><span class="p">,</span> <span class="mf">37.753574</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;vector&quot;</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://api.maptiler.com/tiles/contours/tiles.json?key=</span><span class="si">{</span><span class="n">MAPTILER_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;terrain-data&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;contours&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;contour&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-join&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="s2">&quot;line-cap&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff69b4&quot;</span><span class="p">,</span> <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;contours&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="d-mapping">
<h2><span class="section-number">16.9. </span>3D Mapping<a class="headerlink" href="#d-mapping" title="Link to this heading">#</a></h2>
<p>MapTiler provides a variety of 3D styles that enhance geographic data visualization. Styles can be prefixed with <code class="docutils literal notranslate"><span class="pre">3d-</span></code> to utilize 3D effects such as hybrid, satellite, and topo. The <code class="docutils literal notranslate"><span class="pre">3d-hillshade</span></code> style is used for visualizing hillshade effects alone.</p>
<section id="d-terrain">
<h3><span class="section-number">16.9.1. </span>3D Terrain<a class="headerlink" href="#d-terrain" title="Link to this heading">#</a></h3>
<p>These examples demonstrate different ways to implement 3D terrain visualization:</p>
<ul class="simple">
<li><p><strong>3D Hybrid style</strong>: Adds terrain relief to urban data with hybrid visualization.</p></li>
<li><p><strong>3D Satellite style</strong>: Combines satellite imagery with 3D elevation, enhancing visual context for topography.</p></li>
<li><p><strong>3D Topo style</strong>: Provides a topographic view with elevation exaggeration and optional hillshade.</p></li>
<li><p><strong>3D Terrain style</strong>: Displays terrain with default settings for natural geographic areas.</p></li>
<li><p><strong>3D Ocean style</strong>: A specialized terrain style with oceanic details, using exaggeration and hillshade to emphasize depth.</p></li>
</ul>
<p>Each terrain map setup includes a pitch and bearing to adjust the map’s angle and orientation, giving a better perspective of 3D features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.1874314</span><span class="p">,</span> <span class="mf">46.2022386</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-hybrid&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/3Q2Q3CG.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.1874314</span><span class="p">,</span> <span class="mf">46.2022386</span><span class="p">],</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
    <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">bearing</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-satellite&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/5PNMbAv.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.1874314</span><span class="p">,</span> <span class="mf">46.2022386</span><span class="p">],</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
    <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">bearing</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-topo&quot;</span><span class="p">,</span>
    <span class="n">exaggeration</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">hillshade</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/y33leIj.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.1874314</span><span class="p">,</span> <span class="mf">46.2022386</span><span class="p">],</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
    <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">bearing</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-terrain&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-ocean&quot;</span><span class="p">,</span> <span class="n">exaggeration</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">hillshade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/m6NwSWG.png" /></p>
</section>
<section id="d-buildings">
<h3><span class="section-number">16.9.2. </span>3D Buildings<a class="headerlink" href="#d-buildings" title="Link to this heading">#</a></h3>
<p>Adding 3D buildings enhances urban visualizations, showing buildings with height variations. The setup involves specifying the MapTiler API key for vector tiles and adding building data as a 3D extrusion layer. The extrusion height and color can be set based on data attributes to visualize structures with varying heights, which can be useful in city planning and urban analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.01201</span><span class="p">,</span> <span class="mf">40.70473</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic-v2&quot;</span>
<span class="p">)</span>
<span class="n">MAPTILER_KEY</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">get_api_key</span><span class="p">(</span><span class="s2">&quot;MAPTILER_KEY&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;https://api.maptiler.com/tiles/v3/tiles.json?key=</span><span class="si">{</span><span class="n">MAPTILER_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;vector&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3d-buildings&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;openmaptiles&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;building&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;min-zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;render_height&quot;</span><span class="p">],</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
            <span class="mi">200</span><span class="p">,</span>
            <span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
            <span class="mi">400</span><span class="p">,</span>
            <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span>
            <span class="mi">15</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">16</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;render_height&quot;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-base&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;case&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">16</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;render_min_height&quot;</span><span class="p">],</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;openmaptiles&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/9QeicaE.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.01201</span><span class="p">,</span> <span class="mf">40.70473</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic-v2&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_3d_buildings</span><span class="p">(</span><span class="n">min_zoom</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-indoor-mapping">
<h3><span class="section-number">16.9.3. </span>3D Indoor Mapping<a class="headerlink" href="#d-indoor-mapping" title="Link to this heading">#</a></h3>
<p>Indoor mapping data can be visualized by loading a GeoJSON file and applying the <code class="docutils literal notranslate"><span class="pre">add_geojson</span></code> method. This setup allows for displaying floorplans with attributes such as color, height, and opacity. It provides a realistic indoor perspective, which is useful for visualizing complex structures or navigating interior spaces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;https://maplibre.org/maplibre-gl-js/docs/assets/indoor-3d-map.geojson&quot;</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">geojson_to_gdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">explore</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">87.61694</span><span class="p">,</span> <span class="mf">41.86625</span><span class="p">),</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;OpenStreetMap.Mapnik&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;floorplan&quot;</span><span class="p">,</span>
    <span class="n">paint</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-base&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;base_height&quot;</span><span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-opacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/eYhSWaT.png" /></p>
</section>
<section id="d-choropleth-map">
<h3><span class="section-number">16.9.4. </span>3D Choropleth Map<a class="headerlink" href="#d-choropleth-map" title="Link to this heading">#</a></h3>
<p>Choropleth maps in 3D allow visualizing attribute data by height, where regions are colored and extruded based on specific attributes, such as age or population area. Two examples are provided below:</p>
<ul class="simple">
<li><p><strong>European Countries (Age at First Marriage)</strong>: The map displays different colors and extrusion heights based on age data. Color interpolations help represent data variations across regions, making it a suitable map for demographic studies.</p></li>
<li><p><strong>US Counties (Census Area)</strong>: This example uses census data to display county areas in the United States, where each county’s area is represented with a different color and height based on its size. This type of map provides insights into geographic distribution and area proportions across the region.</p></li>
</ul>
<p>Both maps use a fill-extrusion style to dynamically adjust color and height, creating a 3D effect that enhances data interpretation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">19.43</span><span class="p">,</span> <span class="mf">49.49</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://docs.maptiler.com/sdk-js/assets/Mean_age_of_women_at_first_marriage_in_2019.geojson&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;countries&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;eu-countries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;countries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span>
            <span class="mf">23.0</span><span class="p">,</span>
            <span class="s2">&quot;#fff5eb&quot;</span><span class="p">,</span>
            <span class="mf">24.0</span><span class="p">,</span>
            <span class="s2">&quot;#fee6ce&quot;</span><span class="p">,</span>
            <span class="mf">25.0</span><span class="p">,</span>
            <span class="s2">&quot;#fdd0a2&quot;</span><span class="p">,</span>
            <span class="mf">26.0</span><span class="p">,</span>
            <span class="s2">&quot;#fdae6b&quot;</span><span class="p">,</span>
            <span class="mf">27.0</span><span class="p">,</span>
            <span class="s2">&quot;#fd8d3c&quot;</span><span class="p">,</span>
            <span class="mf">28.0</span><span class="p">,</span>
            <span class="s2">&quot;#f16913&quot;</span><span class="p">,</span>
            <span class="mf">29.0</span><span class="p">,</span>
            <span class="s2">&quot;#d94801&quot;</span><span class="p">,</span>
            <span class="mf">30.0</span><span class="p">,</span>
            <span class="s2">&quot;#8c2d04&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span> <span class="mi">5000</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">first_symbol_layer_id</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">find_first_symbol_layer</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">first_symbol_layer_id</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/fLgqYTa.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://open.gishub.org/data/us/us_counties.geojson&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;counties&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;us-counties&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;counties&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;CENSUSAREA&quot;</span><span class="p">],</span>
            <span class="mi">400</span><span class="p">,</span>
            <span class="s2">&quot;#fff5eb&quot;</span><span class="p">,</span>
            <span class="mi">600</span><span class="p">,</span>
            <span class="s2">&quot;#fee6ce&quot;</span><span class="p">,</span>
            <span class="mi">800</span><span class="p">,</span>
            <span class="s2">&quot;#fdd0a2&quot;</span><span class="p">,</span>
            <span class="mi">1000</span><span class="p">,</span>
            <span class="s2">&quot;#fdae6b&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;CENSUSAREA&quot;</span><span class="p">],</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">first_symbol_layer_id</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">find_first_symbol_layer</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">first_symbol_layer_id</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-vector-data">
<h2><span class="section-number">16.10. </span>Visualizing Vector Data<a class="headerlink" href="#visualizing-vector-data" title="Link to this heading">#</a></h2>
<p>Leafmap provides a variety of methods to visualize vector data on a map, allowing you to display points, lines, polygons, and other vector shapes with custom styling and interactivity.</p>
<section id="point-data">
<h3><span class="section-number">16.10.1. </span>Point Data<a class="headerlink" href="#point-data" title="Link to this heading">#</a></h3>
<p>The following examples demonstrate how to display points on the map.</p>
<ul class="simple">
<li><p><strong>Simple Marker</strong>: Initializes the map centered on a specific latitude and longitude, then adds a static marker to the location.</p></li>
<li><p><strong>Draggable Marker</strong>: Similar to the simple marker, but with an additional option to make the marker draggable. This allows users to reposition it directly on the map.</p></li>
<li><p><strong>Multiple Points with GeoJSON</strong>: Loads point data from a GeoJSON file containing world city locations. After reading the data, it’s added to the map as a layer named “cities.” Popups can be enabled to display additional information when a user clicks on a city.</p></li>
<li><p><strong>Custom Symbol Layer</strong>: Loads point data as symbols instead of markers and customizes the symbol layout using icons, which can be scaled to any size.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">12.550343</span><span class="p">,</span> <span class="mf">55.665957</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_marker</span><span class="p">(</span><span class="n">lng_lat</span><span class="o">=</span><span class="p">[</span><span class="mf">12.550343</span><span class="p">,</span> <span class="mf">55.665957</span><span class="p">])</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/ufmqTzx.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">12.550343</span><span class="p">,</span> <span class="mf">55.665957</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_marker</span><span class="p">(</span><span class="n">lng_lat</span><span class="o">=</span><span class="p">[</span><span class="mf">12.550343</span><span class="p">,</span> <span class="mf">55.665957</span><span class="p">],</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;draggable&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/world/world_cities.geojson&quot;</span>
<span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">read_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cities&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_popup</span><span class="p">(</span><span class="s2">&quot;cities&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">}</span>

<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;cities&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;marker_15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon-size&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_popup</span><span class="p">(</span><span class="s2">&quot;cities&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="customizing-marker-icon-image">
<h3><span class="section-number">16.10.2. </span>Customizing Marker Icon Image<a class="headerlink" href="#customizing-marker-icon-image" title="Link to this heading">#</a></h3>
<p>To further customize point data, an image icon can be used instead of the default marker:</p>
<ul class="simple">
<li><p><strong>Add Custom Icon</strong>: Loads an OSGeo logo as the custom marker image. The GeoJSON source for conference locations is loaded, and each location is marked with the custom icon and labeled with the year. Layout options define the placement of text and icons.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;https://maplibre.org/maplibre-gl-js/docs/assets/osgeo-logo.png&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s2">&quot;custom-marker&quot;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/places/osgeo_conferences.geojson&quot;</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">read_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;conferences&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;conferences&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;conferences&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;custom-marker&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text-field&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-font&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Open Sans Semibold&quot;</span><span class="p">,</span> <span class="s2">&quot;Arial Unicode MS Bold&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-offset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">],</span>
        <span class="s2">&quot;text-anchor&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="line-data">
<h3><span class="section-number">16.10.3. </span>Line Data<a class="headerlink" href="#line-data" title="Link to this heading">#</a></h3>
<p>Lines can be displayed to represent routes, boundaries, or connections between locations:</p>
<ul class="simple">
<li><p><strong>Basic Line</strong>: Sets up a line with multiple coordinates to create a path. The map displays this path with rounded line joins and a defined color and width, giving it a polished appearance.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.486052</span><span class="p">,</span> <span class="mf">37.830348</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>

<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48369693756104</span><span class="p">,</span> <span class="mf">37.83381888486939</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48348236083984</span><span class="p">,</span> <span class="mf">37.83317489144141</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48339653015138</span><span class="p">,</span> <span class="mf">37.83270036637107</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48356819152832</span><span class="p">,</span> <span class="mf">37.832056363179625</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48404026031496</span><span class="p">,</span> <span class="mf">37.83114119107971</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48404026031496</span><span class="p">,</span> <span class="mf">37.83049717427869</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48348236083984</span><span class="p">,</span> <span class="mf">37.829920943955045</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48356819152832</span><span class="p">,</span> <span class="mf">37.82954808664175</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48507022857666</span><span class="p">,</span> <span class="mf">37.82944639795659</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48610019683838</span><span class="p">,</span> <span class="mf">37.82880236636284</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48695850372314</span><span class="p">,</span> <span class="mf">37.82931081282506</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48700141906738</span><span class="p">,</span> <span class="mf">37.83080223556934</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48751640319824</span><span class="p">,</span> <span class="mf">37.83168351665737</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48803138732912</span><span class="p">,</span> <span class="mf">37.832158048267786</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48888969421387</span><span class="p">,</span> <span class="mf">37.83297152392784</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.48987674713133</span><span class="p">,</span> <span class="mf">37.83263257682617</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.49043464660643</span><span class="p">,</span> <span class="mf">37.832937629287755</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.49125003814696</span><span class="p">,</span> <span class="mf">37.832429207817725</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.49163627624512</span><span class="p">,</span> <span class="mf">37.832564787218985</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.49223709106445</span><span class="p">,</span> <span class="mf">37.83337825839438</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">122.49378204345702</span><span class="p">,</span> <span class="mf">37.83368330777276</span><span class="p">],</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;route&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;route&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-join&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="s2">&quot;line-cap&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#888&quot;</span><span class="p">,</span> <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;route&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="polygon-data">
<h3><span class="section-number">16.10.4. </span>Polygon Data<a class="headerlink" href="#polygon-data" title="Link to this heading">#</a></h3>
<p>Polygons represent regions or areas on the map. Leafmap offers options to display filled polygons with customizable colors and opacities.</p>
<ul class="simple">
<li><p><strong>Basic Polygon</strong>: Adds a GeoJSON polygon representing an area and customizes its fill color and opacity.</p></li>
<li><p><strong>Outlined Polygon</strong>: In addition to filling the polygon, an outline color is specified to highlight the polygon’s boundary. Both fill and line layers are defined, enhancing visual clarity.</p></li>
<li><p><strong>Building Visualization with GeoJSON</strong>: Uses a URL to load building data and displays it with a customized fill color and outline. The style uses a hybrid map view for additional context.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">68.137343</span><span class="p">,</span> <span class="mf">45.137451</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
        <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">67.13734351262877</span><span class="p">,</span> <span class="mf">45.137451890638886</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">66.96466</span><span class="p">,</span> <span class="mf">44.8097</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">68.03252</span><span class="p">,</span> <span class="mf">44.3252</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">69.06</span><span class="p">,</span> <span class="mf">43.98</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.11617</span><span class="p">,</span> <span class="mf">43.68405</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.64573401557249</span><span class="p">,</span> <span class="mf">43.090083319667144</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.75102474636725</span><span class="p">,</span> <span class="mf">43.08003225358635</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.79761105007827</span><span class="p">,</span> <span class="mf">43.21973948828747</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.98176001655037</span><span class="p">,</span> <span class="mf">43.36789581966826</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.94416541205806</span><span class="p">,</span> <span class="mf">43.46633942318431</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">71.08482</span><span class="p">,</span> <span class="mf">45.3052400000002</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.6600225491012</span><span class="p">,</span> <span class="mf">45.46022288673396</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.30495378282376</span><span class="p">,</span> <span class="mf">45.914794623389355</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">70.00014034695016</span><span class="p">,</span> <span class="mf">46.69317088478567</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">69.23708614772835</span><span class="p">,</span> <span class="mf">47.44777598732787</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">68.90478084987546</span><span class="p">,</span> <span class="mf">47.184794623394396</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">68.23430497910454</span><span class="p">,</span> <span class="mf">47.35462921812177</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">67.79035274928509</span><span class="p">,</span> <span class="mf">47.066248887716995</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">67.79141211614706</span><span class="p">,</span> <span class="mf">45.702585354182816</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">67.13734351262877</span><span class="p">,</span> <span class="mf">45.137451890638886</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;maine&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;maine&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;maine&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#088&quot;</span><span class="p">,</span> <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">68.137343</span><span class="p">,</span> <span class="mf">45.137451</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">paint</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#088&quot;</span><span class="p">,</span> <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="n">paint</span><span class="o">=</span><span class="n">paint</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;hybrid&quot;</span><span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/places/wa_overture_buildings.geojson&quot;</span>
<span class="n">paint</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffff00&quot;</span><span class="p">,</span> <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;fill-outline-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="n">paint</span><span class="o">=</span><span class="n">paint</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Fill&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;hybrid&quot;</span><span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/places/wa_overture_buildings.geojson&quot;</span>
<span class="n">paint_line</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">paint</span><span class="o">=</span><span class="n">paint_line</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outline&quot;</span><span class="p">)</span>
<span class="n">paint_fill</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ffff00&quot;</span><span class="p">,</span> <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="n">paint</span><span class="o">=</span><span class="n">paint_fill</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Fill&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="multiple-geometries">
<h3><span class="section-number">16.10.5. </span>Multiple Geometries<a class="headerlink" href="#multiple-geometries" title="Link to this heading">#</a></h3>
<p>This example displays both line and extrusion fills for complex data types:</p>
<ul class="simple">
<li><p><strong>Extruded Blocks with Line Overlay</strong>: Loads Vancouver building blocks data and applies both line and fill-extrusion styles. Each block’s height is based on an attribute, which provides a 3D effect. This is useful for visualizing value distribution across an urban landscape.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">123.13</span><span class="p">,</span> <span class="mf">49.254</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dark-matter&quot;</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/geojson/vancouver-blocks.json&quot;</span>
<span class="n">paint_line</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">paint_fill</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="s2">&quot;valuePerSqm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stops&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;grey&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="s2">&quot;darkred&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">50000</span><span class="p">,</span> <span class="s2">&quot;lightblue&quot;</span><span class="p">],</span>
        <span class="p">],</span>
    <span class="p">},</span>
    <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;valuePerSqm&quot;</span><span class="p">]]],</span>
    <span class="s2">&quot;fill-extrusion-opacity&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">paint</span><span class="o">=</span><span class="n">paint_line</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blocks-line&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span> <span class="n">paint</span><span class="o">=</span><span class="n">paint_fill</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blocks-fill&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="marker-cluster">
<h3><span class="section-number">16.10.6. </span>Marker Cluster<a class="headerlink" href="#marker-cluster" title="Link to this heading">#</a></h3>
<p>Clusters help manage large datasets, such as earthquake data, by grouping nearby markers. The color and size of clusters change based on the point count, and filters differentiate individual points from clusters. This example uses nested GeoJSON layers for visualizing clustered earthquake occurrences, with separate styles for individual points and clusters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">103.59179</span><span class="p">,</span> <span class="mf">40.66995</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;https://docs.mapbox.com/mapbox-gl-js/assets/earthquakes.geojson&quot;</span>
<span class="n">source_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cluster&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;cluster_radius&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;cluster_min_points&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;cluster_max_zoom&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s2">&quot;cluster_properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;maxMag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;mag&quot;</span><span class="p">]],</span>
        <span class="s2">&quot;minMag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;mag&quot;</span><span class="p">]],</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;earthquake-circles&quot;</span><span class="p">,</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has&quot;</span><span class="p">,</span> <span class="s2">&quot;point_count&quot;</span><span class="p">]],</span>
    <span class="n">paint</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;circle-color&quot;</span><span class="p">:</span> <span class="s2">&quot;darkblue&quot;</span><span class="p">},</span>
    <span class="n">source_args</span><span class="o">=</span><span class="n">source_args</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;earthquake-clusters&quot;</span><span class="p">,</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;has&quot;</span><span class="p">,</span> <span class="s2">&quot;point_count&quot;</span><span class="p">],</span>
    <span class="n">paint</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;circle-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;step&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;point_count&quot;</span><span class="p">],</span>
            <span class="s2">&quot;#51bbd6&quot;</span><span class="p">,</span>
            <span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;#f1f075&quot;</span><span class="p">,</span>
            <span class="mi">750</span><span class="p">,</span>
            <span class="s2">&quot;#f28cb1&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;circle-radius&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;point_count&quot;</span><span class="p">],</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">source_args</span><span class="o">=</span><span class="n">source_args</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">layer_type</span><span class="o">=</span><span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;earthquake-labels&quot;</span><span class="p">,</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;has&quot;</span><span class="p">,</span> <span class="s2">&quot;point_count&quot;</span><span class="p">],</span>
    <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;text-field&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;point_count_abbreviated&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">source_args</span><span class="o">=</span><span class="n">source_args</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/VWvJKwl.png" /></p>
</section>
<section id="local-vector-data">
<h3><span class="section-number">16.10.7. </span>Local Vector Data<a class="headerlink" href="#local-vector-data" title="Link to this heading">#</a></h3>
<p>Local vector files, such as GeoJSON, can be loaded directly into the map. The example downloads a GeoJSON file representing U.S. states and adds it to the map using <code class="docutils literal notranslate"><span class="pre">open_geojson</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/us/us_states.geojson&quot;</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;data/us_states.geojson&quot;</span>
<span class="n">leafmap</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">open_geojson</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="changing-building-color">
<h3><span class="section-number">16.10.8. </span>Changing Building Color<a class="headerlink" href="#changing-building-color" title="Link to this heading">#</a></h3>
<p>You can customize the color and opacity of buildings based on the map’s zoom level. This example changes building colors from orange at lower zoom levels to lighter shades as the zoom level increases. Additionally, the opacity gradually transitions to fully opaque, making buildings more visible at close-up zoom levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">90.73414</span><span class="p">,</span> <span class="mf">14.55524</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_paint_property</span><span class="p">(</span>
    <span class="s2">&quot;building&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fill-color&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;exponential&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;#e2714b&quot;</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="s2">&quot;#eee695&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_paint_property</span><span class="p">(</span>
    <span class="s2">&quot;building&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fill-opacity&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;exponential&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">add_call</span><span class="p">(</span><span class="s2">&quot;zoomTo&quot;</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">9000</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/PayiTON.png" /></p>
</section>
<section id="adding-a-new-layer-below-labels">
<h3><span class="section-number">16.10.9. </span>Adding a New Layer Below Labels<a class="headerlink" href="#adding-a-new-layer-below-labels" title="Link to this heading">#</a></h3>
<p>A layer can be added below existing labels on the map to enhance clarity without obscuring labels. The urban areas dataset is displayed as a fill layer in a color and opacity that visually distinguishes it from other map elements. The layer is positioned below symbols, allowing place names to remain visible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">88.137343</span><span class="p">,</span> <span class="mf">35.137451</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_50m_urban_areas.geojson&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;urban-areas&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">first_symbol_layer</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">find_first_symbol_layer</span><span class="p">()</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;urban-areas-fill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;urban-areas&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#f08&quot;</span><span class="p">,</span> <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">before_id</span><span class="o">=</span><span class="n">first_symbol_layer</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="heat-map">
<h3><span class="section-number">16.10.10. </span>Heat Map<a class="headerlink" href="#heat-map" title="Link to this heading">#</a></h3>
<p>Heatmaps visually represent data density. This example uses earthquake data and configures the heatmap layer with dynamic properties, such as weight, intensity, color, and radius, based on earthquake magnitudes. Circles are added to indicate individual earthquakes, with colors and sizes varying according to their magnitude.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://maplibre.org/maplibre-gl-js/docs/assets/earthquakes.geojson&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;earthquakes&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;earthquakes-heat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;heatmap&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;earthquakes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;maxzoom&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># Increase the heatmap weight based on frequency and property magnitude</span>
        <span class="s2">&quot;heatmap-weight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;mag&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="c1"># Increase the heatmap color weight weight by zoom level</span>
        <span class="c1"># heatmap-intensity is a multiplier on top of heatmap-weight</span>
        <span class="s2">&quot;heatmap-intensity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="c1"># Color ramp for heatmap.  Domain is 0 (low) to 1 (high).</span>
        <span class="c1"># Begin color ramp at 0-stop with a 0-transparency color</span>
        <span class="c1"># to create a blur-like effect.</span>
        <span class="s2">&quot;heatmap-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;heatmap-density&quot;</span><span class="p">],</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;rgba(33,102,172,0)&quot;</span><span class="p">,</span>
            <span class="mf">0.2</span><span class="p">,</span>
            <span class="s2">&quot;rgb(103,169,207)&quot;</span><span class="p">,</span>
            <span class="mf">0.4</span><span class="p">,</span>
            <span class="s2">&quot;rgb(209,229,240)&quot;</span><span class="p">,</span>
            <span class="mf">0.6</span><span class="p">,</span>
            <span class="s2">&quot;rgb(253,219,199)&quot;</span><span class="p">,</span>
            <span class="mf">0.8</span><span class="p">,</span>
            <span class="s2">&quot;rgb(239,138,98)&quot;</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;rgb(178,24,43)&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="c1"># Adjust the heatmap radius by zoom level</span>
        <span class="s2">&quot;heatmap-radius&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
        <span class="c1"># Transition from heatmap to circle layer by zoom level</span>
        <span class="s2">&quot;heatmap-opacity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">before_id</span><span class="o">=</span><span class="s2">&quot;waterway&quot;</span><span class="p">)</span>
<span class="n">layer2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;earthquakes-point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;earthquakes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;minzoom&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># Size circle radius by earthquake magnitude and zoom level</span>
        <span class="s2">&quot;circle-radius&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span>
            <span class="mi">7</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;mag&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="mi">16</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;mag&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="c1"># Color circle by earthquake magnitude</span>
        <span class="s2">&quot;circle-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;mag&quot;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;rgba(33,102,172,0)&quot;</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;rgb(103,169,207)&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;rgb(209,229,240)&quot;</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;rgb(253,219,199)&quot;</span><span class="p">,</span>
            <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;rgb(239,138,98)&quot;</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;rgb(178,24,43)&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;circle-stroke-color&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="s2">&quot;circle-stroke-width&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="c1"># Transition from heatmap to circle layer by zoom level</span>
        <span class="s2">&quot;circle-opacity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer2</span><span class="p">,</span> <span class="n">before_id</span><span class="o">=</span><span class="s2">&quot;waterway&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/OLCRPKj.png" /></p>
</section>
<section id="visualizing-population-density">
<h3><span class="section-number">16.10.11. </span>Visualizing Population Density<a class="headerlink" href="#visualizing-population-density" title="Link to this heading">#</a></h3>
<p>Population density can be calculated and displayed dynamically. This example loads a GeoJSON of Rwandan provinces, calculating density by dividing population by area. The fill color of each province is then adjusted based on density, with different color schemes applied depending on the zoom level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">30.0222</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.9596</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://maplibre.org/maplibre-gl-js/docs/assets/rwanda-provinces.geojson&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;rwanda-provinces&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;rwanda-provinces&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;rwanda-provinces&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;let&quot;</span><span class="p">,</span>
            <span class="s2">&quot;density&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;population&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;sq-km&quot;</span><span class="p">]],</span>
            <span class="p">[</span>
                <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span>
                <span class="mi">8</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;density&quot;</span><span class="p">],</span>
                    <span class="mi">274</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;to-color&quot;</span><span class="p">,</span> <span class="s2">&quot;#edf8e9&quot;</span><span class="p">],</span>
                    <span class="mi">1551</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;to-color&quot;</span><span class="p">,</span> <span class="s2">&quot;#006d2c&quot;</span><span class="p">],</span>
                <span class="p">],</span>
                <span class="mi">10</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;density&quot;</span><span class="p">],</span>
                    <span class="mi">274</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;to-color&quot;</span><span class="p">,</span> <span class="s2">&quot;#eff3ff&quot;</span><span class="p">],</span>
                    <span class="mi">1551</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;to-color&quot;</span><span class="p">,</span> <span class="s2">&quot;#08519c&quot;</span><span class="p">],</span>
                <span class="p">],</span>
            <span class="p">],</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-raster-data">
<h2><span class="section-number">16.11. </span>Visualizing Raster Data<a class="headerlink" href="#visualizing-raster-data" title="Link to this heading">#</a></h2>
<section id="local-raster-data">
<h3><span class="section-number">16.11.1. </span>Local Raster Data<a class="headerlink" href="#local-raster-data" title="Link to this heading">#</a></h3>
<p>To visualize local raster files, use the <code class="docutils literal notranslate"><span class="pre">add_raster</span></code> method. In the example, a Landsat image is downloaded and displayed using two different band combinations:</p>
<ul class="simple">
<li><p><strong>Band Combination 3-2-1 (True Color)</strong>: Simulates natural colors in the RGB channels.</p></li>
<li><p><strong>Band Combination 4-3-2</strong>: Enhances vegetation, displaying it in red for better visual contrast.
These layers are added to the map along with controls to toggle them. You can adjust brightness and contrast with the <code class="docutils literal notranslate"><span class="pre">vmin</span></code> and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> arguments to improve clarity.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/raster/landsat.tif&quot;</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;landsat.tif&quot;</span>
<span class="n">leafmap</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">indexes</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Landsat-321&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">indexes</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Landsat-432&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A Digital Elevation Model (DEM) is also downloaded and visualized with a terrain color scheme. Leafmap’s <code class="docutils literal notranslate"><span class="pre">layer_interact</span></code> method allows interactive adjustments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/raster/srtm90.tif&quot;</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;srtm90.tif&quot;</span>
<span class="n">leafmap</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_raster</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DEM&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cloud-optimized-geotiff-cog">
<h3><span class="section-number">16.11.2. </span>Cloud Optimized GeoTIFF (COG)<a class="headerlink" href="#cloud-optimized-geotiff-cog" title="Link to this heading">#</a></h3>
<p>Cloud Optimized GeoTIFFs (COG) are large raster files stored on cloud platforms, allowing efficient streaming and loading. This example loads satellite imagery of Libya before and after an event, showing the change over time. Each image is loaded with <code class="docutils literal notranslate"><span class="pre">add_cog_layer</span></code>, and layers can be toggled for comparison. Using <code class="docutils literal notranslate"><span class="pre">fit_bounds</span></code>, the map centers on the COG layer to fit its boundaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span>
<span class="n">before</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/raster/Libya-2023-07-01.tif&quot;</span>
<span class="p">)</span>
<span class="n">after</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/raster/Libya-2023-09-13.tif&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_cog_layer</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Before&quot;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Maxar&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_cog_layer</span><span class="p">(</span><span class="n">after</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;After&quot;</span><span class="p">,</span> <span class="n">attribution</span><span class="o">=</span><span class="s2">&quot;Maxar&quot;</span><span class="p">,</span> <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stac-layer">
<h3><span class="section-number">16.11.3. </span>STAC Layer<a class="headerlink" href="#stac-layer" title="Link to this heading">#</a></h3>
<p>The SpatioTemporal Asset Catalog (STAC) standard organizes large satellite data collections. With <code class="docutils literal notranslate"><span class="pre">add_stac_layer</span></code>, this example loads Canadian satellite data, displaying both a panchromatic and an RGB layer from the same source. This approach allows easy switching between views.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_stac_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pan&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Panchromatic&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_stac_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span> <span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Leafmap also supports loading STAC items from the <a class="reference external" href="https://planetarycomputer.microsoft.com">Microsoft Planetary Computer</a>. The example demonstrates how to load a STAC item from the Planetary Computer and display it on the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="s2">&quot;landsat-8-c2-l2&quot;</span>
<span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;LC08_L2SP_047027_20201204_02_T1&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leafmap</span><span class="o">.</span><span class="n">stac_assets</span><span class="p">(</span><span class="n">collection</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span> <span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">,</span> <span class="n">titiler_endpoint</span><span class="o">=</span><span class="s2">&quot;pc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_stac_layer</span><span class="p">(</span>
    <span class="n">collection</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span>
    <span class="n">item</span><span class="o">=</span><span class="n">item</span><span class="p">,</span>
    <span class="n">assets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SR_B5&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B4&quot;</span><span class="p">,</span> <span class="s2">&quot;SR_B3&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Color infrared&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="interacting-with-the-map">
<h2><span class="section-number">16.12. </span>Interacting with the Map<a class="headerlink" href="#interacting-with-the-map" title="Link to this heading">#</a></h2>
<p>Interactivity allows for a more tailored map experience.</p>
<section id="displaying-a-non-interactive-map">
<h3><span class="section-number">16.12.1. </span>Displaying a Non-Interactive Map<a class="headerlink" href="#displaying-a-non-interactive-map" title="Link to this heading">#</a></h3>
<p>To create a static map, set <code class="docutils literal notranslate"><span class="pre">interactive=False</span></code>. This disables all user interactions, making it ideal for static presentations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.65</span><span class="p">,</span> <span class="mf">45.52</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="p">{}</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="disabling-scroll-zoom">
<h3><span class="section-number">16.12.2. </span>Disabling Scroll Zoom<a class="headerlink" href="#disabling-scroll-zoom" title="Link to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">scroll_zoom=False</span></code> to prevent map zooming with the scroll wheel, maintaining a fixed zoom level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.65</span><span class="p">,</span> <span class="mf">45.52</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">scroll_zoom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitting-bounds">
<h3><span class="section-number">16.12.3. </span>Fitting Bounds<a class="headerlink" href="#fitting-bounds" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">fit_bounds</span></code> method focuses the map on a specified area. In this example, the map centers on Kenya. Additionally, a GeoJSON line is added to the map, and its bounds are automatically calculated with <code class="docutils literal notranslate"><span class="pre">geojson_bounds</span></code> for a custom zoom fit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Fit to Kenya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">32.958984</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.353521</span><span class="p">],</span> <span class="p">[</span><span class="mf">43.50585</span><span class="p">,</span> <span class="mf">5.615985</span><span class="p">]]</span>
<span class="n">m</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">77.0214</span><span class="p">,</span> <span class="mf">38.897</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>

<span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.0366048812866</span><span class="p">,</span> <span class="mf">38.89873175227713</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.03364372253417</span><span class="p">,</span> <span class="mf">38.89876515143842</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.03364372253417</span><span class="p">,</span> <span class="mf">38.89549195896866</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.02982425689697</span><span class="p">,</span> <span class="mf">38.89549195896866</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.02400922775269</span><span class="p">,</span> <span class="mf">38.89387200688839</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.01519012451172</span><span class="p">,</span> <span class="mf">38.891416957534204</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.01521158218382</span><span class="p">,</span> <span class="mf">38.892068305429156</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.00813055038452</span><span class="p">,</span> <span class="mf">38.892051604275686</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.00832366943358</span><span class="p">,</span> <span class="mf">38.89143365883688</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.00818419456482</span><span class="p">,</span> <span class="mf">38.89082405874451</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">77.00815200805664</span><span class="p">,</span> <span class="mf">38.88989712255097</span><span class="p">],</span>
                <span class="p">],</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">],</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;LineString&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">})</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-join&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="s2">&quot;line-cap&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#BF93E4&quot;</span><span class="p">,</span> <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">geojson_bounds</span><span class="p">(</span><span class="n">geojson</span><span class="p">)</span>
<span class="n">bounds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="restricting-map-panning-to-an-area">
<h3><span class="section-number">16.12.4. </span>Restricting Map Panning to an Area<a class="headerlink" href="#restricting-map-panning-to-an-area" title="Link to this heading">#</a></h3>
<p>To limit map panning to a specific area, define a bounding box. The map is then restricted within the bounds, ensuring users do not accidentally pan away from the area of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">74.04728500751165</span><span class="p">,</span> <span class="mf">40.68392799015035</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">73.91058699000139</span><span class="p">,</span> <span class="mf">40.87764500765852</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">73.9978</span><span class="p">,</span> <span class="mf">40.7209</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">max_bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="flying-to">
<h3><span class="section-number">16.12.5. </span>Flying To<a class="headerlink" href="#flying-to" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">fly_to</span></code> method smoothly navigates to specified coordinates. Parameters like speed and zoom provide control over the fly-to effect. This example flies from the initial map location to New York City.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.242467</span><span class="p">,</span> <span class="mf">53.478122</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">fly_to</span><span class="p">(</span><span class="n">lon</span><span class="o">=-</span><span class="mf">73.983609</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="mf">40.754368</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mf">74.5</span><span class="p">,</span>
    <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;bearing&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s2">&quot;curve&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;essential&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">fly_to</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="jumping-to-a-series-of-locations">
<h3><span class="section-number">16.12.6. </span>Jumping to a Series of Locations<a class="headerlink" href="#jumping-to-a-series-of-locations" title="Link to this heading">#</a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">jump_to</span></code>, you can navigate between multiple locations. This example sets up a list of coordinates representing cities and automatically pans to each one in sequence. Adding a delay between transitions enhances the animation effect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">100.507</span><span class="p">,</span> <span class="mf">13.745</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>

<span class="n">cities</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">100.507</span><span class="p">,</span> <span class="mf">13.745</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">98.993</span><span class="p">,</span> <span class="mf">18.793</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">99.838</span><span class="p">,</span> <span class="mf">19.924</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">102.812</span><span class="p">,</span> <span class="mf">17.408</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">100.458</span><span class="p">,</span> <span class="mf">7.001</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">100.905</span><span class="p">,</span> <span class="mf">12.935</span><span class="p">]},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">city</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cities</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">city</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span>
    <span class="n">m</span><span class="o">.</span><span class="n">jump_to</span><span class="p">({</span><span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="n">coords</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="getting-coordinates-of-the-mouse-pointer">
<h3><span class="section-number">16.12.7. </span>Getting Coordinates of the Mouse Pointer<a class="headerlink" href="#getting-coordinates-of-the-mouse-pointer" title="Link to this heading">#</a></h3>
<p>With widgets, you can display the current mouse pointer coordinates as it moves across the map. This is useful for precision mapping tasks where knowing exact coordinates is essential.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">clicked</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">log_lng_lat</span><span class="p">(</span><span class="n">lng_lat</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">lng_lat</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>


<span class="n">m</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">log_lng_lat</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;clicked&quot;</span><span class="p">)</span>
<span class="n">output</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="customizing-layer-styles">
<h2><span class="section-number">16.13. </span>Customizing Layer Styles<a class="headerlink" href="#customizing-layer-styles" title="Link to this heading">#</a></h2>
<p>Customizing layer styles enables personalized map designs.</p>
<section id="changing-layer-color">
<h3><span class="section-number">16.13.1. </span>Changing Layer Color<a class="headerlink" href="#changing-layer-color" title="Link to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">style_layer_interact</span></code> to interactively change the color of map layers, such as water bodies. This method provides an interactive palette for immediate style changes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">12.338</span><span class="p">,</span> <span class="mf">45.4385</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">style_layer_interact</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;water&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="changing-case-of-labels">
<h3><span class="section-number">16.13.2. </span>Changing Case of Labels<a class="headerlink" href="#changing-case-of-labels" title="Link to this heading">#</a></h3>
<p>This example displays labels in upper or lower case based on their properties. The layout options let you customize font, size, and alignment. For example, facility names are displayed in uppercase, and comments are displayed in lowercase for contrast.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">116.231</span><span class="p">,</span> <span class="mf">43.604</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://maplibre.org/maplibre-gl-js/docs/assets/boise.geojson&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;off-leash-areas&quot;</span><span class="p">,</span> <span class="n">geojson</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;off-leash-areas&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;off-leash-areas&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;dog-park-11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text-field&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;format&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;upcase&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;FacilityName&quot;</span><span class="p">]],</span>
            <span class="p">{</span><span class="s2">&quot;font-scale&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">{},</span>
            <span class="p">[</span><span class="s2">&quot;downcase&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;Comments&quot;</span><span class="p">]],</span>
            <span class="p">{</span><span class="s2">&quot;font-scale&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">},</span>
        <span class="p">],</span>
        <span class="s2">&quot;text-font&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Open Sans Semibold&quot;</span><span class="p">,</span> <span class="s2">&quot;Arial Unicode MS Bold&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-offset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
        <span class="s2">&quot;text-anchor&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/FzGOovv.png" /></p>
</section>
<section id="variable-label-placement">
<h3><span class="section-number">16.13.3. </span>Variable Label Placement<a class="headerlink" href="#variable-label-placement" title="Link to this heading">#</a></h3>
<p>Labels can be automatically positioned around features with <code class="docutils literal notranslate"><span class="pre">text-variable-anchor</span></code>. This example defines multiple anchor points for labels to avoid overlap and ensure clear visibility. The radial offset and auto-justification properties create a professional, clutter-free appearance around points of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">77.04</span><span class="p">,</span> <span class="mf">38.907</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>

<span class="n">places</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ford&#39;s Theater&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;theatre&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.038659</span><span class="p">,</span> <span class="mf">38.931567</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The Gaslight&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;theatre&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.003168</span><span class="p">,</span> <span class="mf">38.894651</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Horrible Harry&#39;s&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.090372</span><span class="p">,</span> <span class="mf">38.881189</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Bike Party&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;bicycle&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.052477</span><span class="p">,</span> <span class="mf">38.943951</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Rockabilly Rockstars&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;music&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.031706</span><span class="p">,</span> <span class="mf">38.914581</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;District Drum Tribe&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;music&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.020945</span><span class="p">,</span> <span class="mf">38.878241</span><span class="p">]},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Motown Memories&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;music&quot;</span><span class="p">},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.007481</span><span class="p">,</span> <span class="mf">38.876516</span><span class="p">]},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">places</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;places&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>

<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;poi-labels&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;places&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;text-field&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-variable-anchor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-radial-offset&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;text-justify&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;concat&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;icon&quot;</span><span class="p">],</span> <span class="s2">&quot;_15&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">rotate_to</span><span class="p">(</span><span class="n">bearing</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="adding-custom-components">
<h2><span class="section-number">16.14. </span>Adding Custom Components<a class="headerlink" href="#adding-custom-components" title="Link to this heading">#</a></h2>
<p>Enhance your maps by adding custom components such as images, videos, text, color bars, and legends.</p>
<section id="adding-image">
<h3><span class="section-number">16.14.1. </span>Adding Image<a class="headerlink" href="#adding-image" title="Link to this heading">#</a></h3>
<p>You can add an image as an overlay or as an icon for a specific layer. For instance:</p>
<ul class="simple">
<li><p>Overlaying an image directly on the map at the “bottom-right” corner.</p></li>
<li><p>Adding an icon image to a feature. In the example, a “cat” image is loaded, and a marker is added at coordinates <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0]</span></code> with a label “I love kitty!” above the icon.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">0.349419</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.80921</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;https://upload.wikimedia.org/wikipedia/commons/7/7c/201408_cat.png&quot;</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;points&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon-size&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
        <span class="s2">&quot;text-field&quot;</span><span class="p">:</span> <span class="s2">&quot;I love kitty!&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text-font&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Open Sans Regular&quot;</span><span class="p">],</span>
        <span class="s2">&quot;text-offset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="s2">&quot;text-anchor&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/Nq1uV9d.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;https://i.imgur.com/LmTETPX.png&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;&lt;img src=&quot;https://i.imgur.com/LmTETPX.png&quot;&gt;&#39;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_html</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;transparent&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>To customize icons, you can also generate icon data with <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, creating unique color gradients and using it as a map icon.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># Generate the icon data</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1"># The image will be 64 pixels square</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">bytes_per_pixel</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Each pixel is represented by 4 bytes: red, green, blue, and alpha</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">bytes_per_pixel</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">y</span> <span class="o">/</span> <span class="n">width</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>  <span class="c1"># red</span>
        <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">x</span> <span class="o">/</span> <span class="n">width</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span>  <span class="c1"># green</span>
        <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span>  <span class="c1"># blue</span>
        <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>  <span class="c1"># alpha</span>

<span class="c1"># Flatten the data array</span>
<span class="n">flat_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># Create the image dictionary</span>
<span class="n">image_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">flat_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
<span class="p">}</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s2">&quot;gradient&quot;</span><span class="p">,</span> <span class="n">image_dict</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}}</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;points&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;gradient&quot;</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/qWWlnAm.png" /></p>
</section>
<section id="adding-text">
<h3><span class="section-number">16.14.2. </span>Adding Text<a class="headerlink" href="#adding-text" title="Link to this heading">#</a></h3>
<p>Add text annotations to the map, specifying parameters like font size and background color. For example:</p>
<ul class="simple">
<li><p>Text “Hello World” in the bottom-right corner with a transparent background.</p></li>
<li><p>“Awesome Text!” in the top-left corner with a slightly opaque white background, making it stand out.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">)</span>
<span class="n">text2</span> <span class="o">=</span> <span class="s2">&quot;Awesome Text!&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">text2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;rgba(255, 255, 255, 0.8)&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;top-left&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/UAtlh3r.png" /></p>
</section>
<section id="adding-gif">
<h3><span class="section-number">16.14.3. </span>Adding GIF<a class="headerlink" href="#adding-gif" title="Link to this heading">#</a></h3>
<p>GIFs can be added as animated overlays to bring your map to life. Example: add a sloth GIF in the bottom-right and a second GIF in the bottom-left corner, with a text label indicating “I love sloth!” for added character.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;https://i.imgur.com/KeiAsTv.gif&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;I love sloth!🦥&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;20px&quot;</span><span class="p">)</span>
<span class="n">image2</span> <span class="o">=</span> <span class="s2">&quot;https://i.imgur.com/kZC2tpr.gif&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image2</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;transparent&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-left&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/auytBtD.png" /></p>
</section>
<section id="adding-html">
<h3><span class="section-number">16.14.4. </span>Adding HTML<a class="headerlink" href="#adding-html" title="Link to this heading">#</a></h3>
<p>Embed custom HTML content to display various HTML elements, such as emojis or stylized text. You can also adjust the font size and background transparency for better integration into the map design.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">&lt;style&gt;</span>
<span class="s2">body {</span>
<span class="s2">  font-size: 20px;</span>
<span class="s2">}</span>
<span class="s2">&lt;/style&gt;</span>
<span class="s2">&lt;body&gt;</span>

<span class="s2">&lt;span style=&#39;font-size:100px;&#39;&gt;&amp;#128640;&lt;/span&gt;</span>
<span class="s2">&lt;p&gt;I will display &amp;#128641;&lt;/p&gt;</span>
<span class="s2">&lt;p&gt;I will display &amp;#128642;&lt;/p&gt;</span>

<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_html</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;transparent&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/TgalNOv.png" /></p>
</section>
<section id="adding-color-bar">
<h3><span class="section-number">16.14.5. </span>Adding Color bar<a class="headerlink" href="#adding-color-bar" title="Link to this heading">#</a></h3>
<p>Adding a color bar enhances data interpretation. In the example:</p>
<ol class="arabic simple">
<li><p>A Digital Elevation Model (DEM) is displayed with a color ramp from 0 to 1500 meters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_colorbar</span></code> method is used to create a color bar with labels, adjusting its position, opacity, and orientation for optimal readability.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;topo&quot;</span><span class="p">)</span>
<span class="n">dem</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/raster/dem.tif&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_cog_layer</span><span class="p">(</span>
    <span class="n">dem</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DEM&quot;</span><span class="p">,</span>
    <span class="n">colormap_name</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">rescale</span><span class="o">=</span><span class="s2">&quot;0, 1500&quot;</span><span class="p">,</span>
    <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Elevation (m)&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Make the color bar background transparent to blend seamlessly with the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;topo&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_cog_layer</span><span class="p">(</span>
    <span class="n">dem</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DEM&quot;</span><span class="p">,</span>
    <span class="n">colormap_name</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">rescale</span><span class="o">=</span><span class="s2">&quot;0, 1500&quot;</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Elevation (m)&quot;</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">,</span>
    <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Make the color bar vertical for a different layout.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;topo&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_cog_layer</span><span class="p">(</span>
    <span class="n">dem</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DEM&quot;</span><span class="p">,</span>
    <span class="n">colormap_name</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">rescale</span><span class="o">=</span><span class="s2">&quot;0, 1500&quot;</span><span class="p">,</span>
    <span class="n">nodata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Elevation (m)&quot;</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-legend">
<h3><span class="section-number">16.14.6. </span>Adding Legend<a class="headerlink" href="#adding-legend" title="Link to this heading">#</a></h3>
<p>Custom legends help users understand data classifications. Two methods are shown:</p>
<ol class="arabic simple">
<li><p>Using built-in legends, such as for NLCD (National Land Cover Database) or wetland types.</p></li>
<li><p>Custom legends are built with a dictionary of land cover types and colors. This legend provides descriptive color-coding for various land cover types, with configurable background opacity to blend with the map.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.mrlc.gov/geoserver/mrlc_display/NLCD_2021_Land_Cover_L48/wms&quot;</span>
<span class="n">layers</span> <span class="o">=</span> <span class="s2">&quot;NLCD_2021_Land_Cover_L48&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NLCD 2021&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;NLCD Land Cover Type&quot;</span><span class="p">,</span>
    <span class="n">builtin_legend</span><span class="o">=</span><span class="s2">&quot;NLCD&quot;</span><span class="p">,</span>
    <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;rgba(255, 255, 255, 0.5)&quot;</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://fwspublicservices.wim.usgs.gov/wetlandsmapservice/services/Wetlands/MapServer/WMSServer&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NWI&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s2">&quot;NWI&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Wetland Type&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.mrlc.gov/geoserver/mrlc_display/NLCD_2021_Land_Cover_L48/wms&quot;</span>
<span class="n">layers</span> <span class="o">=</span> <span class="s2">&quot;NLCD_2021_Land_Cover_L48&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_wms_layer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NLCD 2021&quot;</span><span class="p">)</span>

<span class="n">legend_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;11 Open Water&quot;</span><span class="p">:</span> <span class="s2">&quot;466b9f&quot;</span><span class="p">,</span>
    <span class="s2">&quot;12 Perennial Ice/Snow&quot;</span><span class="p">:</span> <span class="s2">&quot;d1def8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;21 Developed, Open Space&quot;</span><span class="p">:</span> <span class="s2">&quot;dec5c5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;22 Developed, Low Intensity&quot;</span><span class="p">:</span> <span class="s2">&quot;d99282&quot;</span><span class="p">,</span>
    <span class="s2">&quot;23 Developed, Medium Intensity&quot;</span><span class="p">:</span> <span class="s2">&quot;eb0000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;24 Developed High Intensity&quot;</span><span class="p">:</span> <span class="s2">&quot;ab0000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;31 Barren Land (Rock/Sand/Clay)&quot;</span><span class="p">:</span> <span class="s2">&quot;b3ac9f&quot;</span><span class="p">,</span>
    <span class="s2">&quot;41 Deciduous Forest&quot;</span><span class="p">:</span> <span class="s2">&quot;68ab5f&quot;</span><span class="p">,</span>
    <span class="s2">&quot;42 Evergreen Forest&quot;</span><span class="p">:</span> <span class="s2">&quot;1c5f2c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;43 Mixed Forest&quot;</span><span class="p">:</span> <span class="s2">&quot;b5c58f&quot;</span><span class="p">,</span>
    <span class="s2">&quot;51 Dwarf Scrub&quot;</span><span class="p">:</span> <span class="s2">&quot;af963c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;52 Shrub/Scrub&quot;</span><span class="p">:</span> <span class="s2">&quot;ccb879&quot;</span><span class="p">,</span>
    <span class="s2">&quot;71 Grassland/Herbaceous&quot;</span><span class="p">:</span> <span class="s2">&quot;dfdfc2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;72 Sedge/Herbaceous&quot;</span><span class="p">:</span> <span class="s2">&quot;d1d182&quot;</span><span class="p">,</span>
    <span class="s2">&quot;73 Lichens&quot;</span><span class="p">:</span> <span class="s2">&quot;a3cc51&quot;</span><span class="p">,</span>
    <span class="s2">&quot;74 Moss&quot;</span><span class="p">:</span> <span class="s2">&quot;82ba9e&quot;</span><span class="p">,</span>
    <span class="s2">&quot;81 Pasture/Hay&quot;</span><span class="p">:</span> <span class="s2">&quot;dcd939&quot;</span><span class="p">,</span>
    <span class="s2">&quot;82 Cultivated Crops&quot;</span><span class="p">:</span> <span class="s2">&quot;ab6c28&quot;</span><span class="p">,</span>
    <span class="s2">&quot;90 Woody Wetlands&quot;</span><span class="p">:</span> <span class="s2">&quot;b8d9eb&quot;</span><span class="p">,</span>
    <span class="s2">&quot;95 Emergent Herbaceous Wetlands&quot;</span><span class="p">:</span> <span class="s2">&quot;6c9fb8&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;NLCD Land Cover Type&quot;</span><span class="p">,</span>
    <span class="n">legend_dict</span><span class="o">=</span><span class="n">legend_dict</span><span class="p">,</span>
    <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;rgba(255, 255, 255, 0.5)&quot;</span><span class="p">,</span>
    <span class="n">position</span><span class="o">=</span><span class="s2">&quot;bottom-left&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/dy60trf.png" /></p>
</section>
<section id="adding-video">
<h3><span class="section-number">16.14.7. </span>Adding Video<a class="headerlink" href="#adding-video" title="Link to this heading">#</a></h3>
<p>Videos can be added with geographic context by specifying corner coordinates. Videos must be listed in multiple formats to ensure compatibility across browsers. The coordinates array should define the video’s location on the map in the order: top-left, top-right, bottom-right, and bottom-left. This is demonstrated by adding drone footage to a satellite map view, enhancing the user experience with real-world visuals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.514426</span><span class="p">,</span> <span class="mf">37.562984</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=-</span><span class="mi">96</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span>
<span class="p">)</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;https://static-assets.mapbox.com/mapbox-gl-js/drone.mp4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://static-assets.mapbox.com/mapbox-gl-js/drone.webm&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">122.51596391201019</span><span class="p">,</span> <span class="mf">37.56238816766053</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">122.51467645168304</span><span class="p">,</span> <span class="mf">37.56410183312965</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">122.51309394836426</span><span class="p">,</span> <span class="mf">37.563391708549425</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">122.51423120498657</span><span class="p">,</span> <span class="mf">37.56161849366671</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">115</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;https://data.opengeos.org/patricia_nasa.mp4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://data.opengeos.org/patricia_nasa.webm&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">130</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">130</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pmtiles">
<h2><span class="section-number">16.15. </span>PMTiles<a class="headerlink" href="#pmtiles" title="Link to this heading">#</a></h2>
<p>Leafmap supports visualizing <a class="reference external" href="https://protomaps.com/docs/pmtiles/">PMTiles</a>, which enables efficient storage and fast rendering of vector tiles directly in the browser.</p>
<section id="protomaps-sample-data">
<h3><span class="section-number">16.15.1. </span>Protomaps Sample Data<a class="headerlink" href="#protomaps-sample-data" title="Link to this heading">#</a></h3>
<p>Load Protomaps data in PMTiles format for fast, high-resolution vector map data rendering. Use <code class="docutils literal notranslate"><span class="pre">pmtiles_metadata()</span></code> to fetch details like layer names and map bounds, then style and add these tiles to your map. For instance, the example shows two layers: <code class="docutils literal notranslate"><span class="pre">buildings</span></code> styled in “steelblue” and <code class="docutils literal notranslate"><span class="pre">roads</span></code> styled in “black”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://open.gishub.org/data/pmtiles/protomaps_firenze.pmtiles&quot;</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">pmtiles_metadata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;layer names: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;layer_names&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bounds: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;bounds&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>

<span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;example_source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;vector&quot;</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;pmtiles://&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;PMTiles&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;example_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;landuse&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;steelblue&quot;</span><span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;roads&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;example_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;roads&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>

<span class="c1"># style = leafmap.pmtiles_style(url)  # Use default style</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_pmtiles</span><span class="p">(</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="source-cooperative-data">
<h3><span class="section-number">16.15.2. </span>Source Cooperative Data<a class="headerlink" href="#source-cooperative-data" title="Link to this heading">#</a></h3>
<p>Visualize the <a class="reference external" href="https://beta.source.coop/repositories/vida/google-microsoft-open-buildings/description">Google-Microsoft Open Buildings dataset</a>, managed by VIDA, in PMTiles format. Fetch metadata to identify available layers, apply custom styles to the building footprints, and render them with semi-transparent colors for a clear visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://data.source.coop/vida/google-microsoft-open-buildings/pmtiles/go_ms_building_footprints.pmtiles&quot;</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">pmtiles_metadata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;layer names: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;layer_names&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bounds: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;bounds&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Google Hybrid&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;example_source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;vector&quot;</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;pmtiles://&quot;</span> <span class="o">+</span> <span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;attribution&quot;</span><span class="p">:</span> <span class="s2">&quot;PMTiles&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;example_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;building_footprints&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fill-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#3388ff&quot;</span><span class="p">,</span> <span class="s2">&quot;fill-opacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>

<span class="c1"># style = leafmap.pmtiles_style(url)  # Use default style</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_pmtiles</span><span class="p">(</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-pmtiles">
<h3><span class="section-number">16.15.3. </span>3D PMTiles<a class="headerlink" href="#d-pmtiles" title="Link to this heading">#</a></h3>
<p>Render global building data in 3D for a realistic, textured experience. Set building colors and extrusion heights to create visually compelling cityscapes. For example, apply color gradients and height scaling based on building attributes to differentiate buildings by their heights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://data.source.coop/cholmes/overture/overture-buildings.pmtiles&quot;</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">pmtiles_metadata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;layer names: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;layer_names&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bounds: </span><span class="si">{</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;bounds&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=-</span><span class="mi">17</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;OpenStreetMap.Mapnik&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;example_source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span>
            <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">],</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">],</span>  <span class="c1"># only show buildings with height info</span>
            <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">],</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>
                    <span class="mi">200</span><span class="p">,</span>
                    <span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
                    <span class="mi">400</span><span class="p">,</span>
                    <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_pmtiles</span><span class="p">(</span>
    <span class="n">url</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">template</span><span class="o">=</span><span class="s2">&quot;Height: {{height}}&lt;br&gt;Country: {{country_iso}}&quot;</span><span class="p">,</span>
    <span class="n">fit_bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3><span class="section-number">16.15.4. </span>3D Buildings<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>For a simplified setup, the <code class="docutils literal notranslate"><span class="pre">add_overture_3d_buildings</span></code> function quickly adds 3D building data from Overture’s latest release to a basemap, creating depth and spatial realism on the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=-</span><span class="mi">17</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_3d_buildings</span><span class="p">(</span><span class="n">release</span><span class="o">=</span><span class="s2">&quot;2024-09-18&quot;</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-buildings-transportation-and-other-themes">
<h3><span class="section-number">16.15.5. </span>2D Buildings, Transportation, and Other Themes<a class="headerlink" href="#d-buildings-transportation-and-other-themes" title="Link to this heading">#</a></h3>
<p>Switch between specific Overture themes, such as <code class="docutils literal notranslate"><span class="pre">buildings</span></code>, <code class="docutils literal notranslate"><span class="pre">transportation</span></code>, <code class="docutils literal notranslate"><span class="pre">places</span></code>, or <code class="docutils literal notranslate"><span class="pre">addresses</span></code>, depending on the data focus. Each theme overlays relevant features with adjustable opacity for thematic visualization, providing easy customization for urban planning or transportation studies.</p>
<p>Building theme:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_data</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Transportation theme:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_data</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s2">&quot;transportation&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Places theme:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_data</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s2">&quot;places&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Addresses theme:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_data</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s2">&quot;addresses&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Base theme:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0095</span><span class="p">,</span> <span class="mf">40.7046</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_data</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s2">&quot;base&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Divisions themem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_overture_data</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="s2">&quot;divisions&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="deck-gl-layers">
<h2><span class="section-number">16.16. </span><a class="reference external" href="http://Deck.GL">Deck.GL</a> Layers<a class="headerlink" href="#deck-gl-layers" title="Link to this heading">#</a></h2>
<p>Integrate interactive, high-performance visualization layers using <a class="reference external" href="http://Deck.GL">Deck.GL</a>. Leafmap’s <code class="docutils literal notranslate"><span class="pre">add_deck_layer</span></code> method supports multiple <a class="reference external" href="http://Deck.GL">Deck.GL</a> layer types, including Grid, GeoJSON, and Arc layers.</p>
<section id="single-deck-gl-layer">
<h3><span class="section-number">16.16.1. </span>Single <a class="reference external" href="http://Deck.GL">Deck.GL</a> Layer<a class="headerlink" href="#single-deck-gl-layer" title="Link to this heading">#</a></h3>
<p>Add a <code class="docutils literal notranslate"><span class="pre">GridLayer</span></code> to visualize point data, such as the density of bike parking in San Francisco. Customize the grid cell size, elevation, and color to represent data density visually and interactively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">122.4</span><span class="p">,</span> <span class="mf">37.74</span><span class="p">),</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">pitch</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">deck_grid_layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;@@type&quot;</span><span class="p">:</span> <span class="s2">&quot;GridLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;GridLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/sf-bike-parking.json&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extruded&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;getPosition&quot;</span><span class="p">:</span> <span class="s2">&quot;@@=COORDINATES&quot;</span><span class="p">,</span>
    <span class="s2">&quot;getColorWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;@@=SPACES&quot;</span><span class="p">,</span>
    <span class="s2">&quot;getElevationWeight&quot;</span><span class="p">:</span> <span class="s2">&quot;@@=SPACES&quot;</span><span class="p">,</span>
    <span class="s2">&quot;elevationScale&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;cellSize&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;pickable&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_deck_layers</span><span class="p">([</span><span class="n">deck_grid_layer</span><span class="p">],</span> <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Number of points: {{ count }}&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="multiple-deck-gl-layers">
<h3><span class="section-number">16.16.2. </span>Multiple <a class="reference external" href="http://Deck.GL">Deck.GL</a> Layers<a class="headerlink" href="#multiple-deck-gl-layers" title="Link to this heading">#</a></h3>
<p>Combine layers like <code class="docutils literal notranslate"><span class="pre">GeoJsonLayer</span></code> and <code class="docutils literal notranslate"><span class="pre">ArcLayer</span></code> for complex visualizations. For example:</p>
<ol class="arabic simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">GeoJsonLayer</span></code> to show airports with varying point sizes based on significance.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">ArcLayer</span></code> to connect selected airports with London, coloring arcs to represent different paths.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_10m_airports.geojson&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">read_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;positron&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">51.47</span><span class="p">),</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">pitch</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">deck_geojson_layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;@@type&quot;</span><span class="p">:</span> <span class="s2">&quot;GeoJsonLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;airports&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="s2">&quot;filled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;pointRadiusMinPixels&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;pointRadiusScale&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="s2">&quot;getPointRadius&quot;</span><span class="p">:</span> <span class="s2">&quot;@@=11 - properties.scalerank&quot;</span><span class="p">,</span>
    <span class="s2">&quot;getFillColor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span>
    <span class="s2">&quot;autoHighlight&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;pickable&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">deck_arc_layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;@@type&quot;</span><span class="p">:</span> <span class="s2">&quot;ArcLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;arcs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">feature</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">feature</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;scalerank&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span>
    <span class="p">],</span>
    <span class="s2">&quot;getSourcePosition&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.4531566</span><span class="p">,</span> <span class="mf">51.4709959</span><span class="p">],</span>  <span class="c1"># London</span>
    <span class="s2">&quot;getTargetPosition&quot;</span><span class="p">:</span> <span class="s2">&quot;@@=geometry.coordinates&quot;</span><span class="p">,</span>
    <span class="s2">&quot;getSourceColor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="s2">&quot;getTargetColor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
    <span class="s2">&quot;getWidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;pickable&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">add_deck_layers</span><span class="p">(</span>
    <span class="p">[</span><span class="n">deck_geojson_layer</span><span class="p">,</span> <span class="n">deck_arc_layer</span><span class="p">],</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;airports&quot;</span><span class="p">:</span> <span class="s2">&quot;{{ &amp;properties.name }}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;arcs&quot;</span><span class="p">:</span> <span class="s2">&quot;gps_code: {{ properties.gps_code }}&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>The result is a rich, interactive visualization that highlights both point data and relational data connections, useful for airport connectivity or hub-and-spoke modeling.</p>
</section>
</section>
<section id="google-earth-engine">
<h2><span class="section-number">16.17. </span>Google Earth Engine<a class="headerlink" href="#google-earth-engine" title="Link to this heading">#</a></h2>
<p>Leafmap enables integration with the Google Earth Engine (GEE) Python API, allowing for powerful visualization of Earth Engine datasets directly on a Leafmap map.</p>
<p>To add Earth Engine layers, initialize a map and use <code class="docutils literal notranslate"><span class="pre">add_ee_layer</span></code> to add specific datasets, such as ESA WorldCover data. A legend can be included using <code class="docutils literal notranslate"><span class="pre">add_legend</span></code> to provide a visual reference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">120.4482</span><span class="p">,</span> <span class="mf">38.0399</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-terrain&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_ee_layer</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;ESA/WorldCover/v200&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s2">&quot;ESA_WorldCover&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ESA Landcover&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">layer_interact</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/oHQDf79.png" /></p>
<p>You can overlay Earth Engine data with other 3D elements, like buildings, to create a multi-layered, interactive map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.012998</span><span class="p">,</span> <span class="mf">40.70414</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">15.6</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-terrain&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_ee_layer</span><span class="p">(</span><span class="n">asset_id</span><span class="o">=</span><span class="s2">&quot;ESA/WorldCover/v200&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_3d_buildings</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">builtin_legend</span><span class="o">=</span><span class="s2">&quot;ESA_WorldCover&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ESA Landcover&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/Y52jep5.png" /></p>
<p>If you have an Earth Engine account, authenticate and initialize Earth Engine in your notebook by uncommenting the relevant code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import ee</span>

<span class="c1"># ee.Authenticate()</span>
<span class="c1"># ee.Initialize(project=&quot;YOUR-PROJECT-ID&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># m = leafmap.Map(center=[-120.4482, 38.03994], zoom=13, pitch=60, bearing=30, style=&quot;3d-terrain&quot;)</span>
<span class="c1"># dataset = ee.ImageCollection(&quot;ESA/WorldCover/v200&quot;).first()</span>
<span class="c1"># vis_params = {&quot;bands&quot;: [&quot;Map&quot;]}</span>
<span class="c1"># m.add_ee_layer(dataset, vis_params, name=&quot;ESA Worldcover&quot;, opacity=0.5)</span>
<span class="c1"># m.add_legend(builtin_legend=&quot;ESA_WorldCover&quot;, title=&quot;ESA Landcover&quot;)</span>
<span class="c1"># m.add_layer_control()</span>
<span class="c1"># m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="animations">
<h2><span class="section-number">16.18. </span>Animations<a class="headerlink" href="#animations" title="Link to this heading">#</a></h2>
<section id="animating-a-line">
<h3><span class="section-number">16.18.1. </span>Animating a Line<a class="headerlink" href="#animating-a-line" title="Link to this heading">#</a></h3>
<p>Using Leafmap’s animation capabilities, you can animate a line by updating the coordinates of a GeoJSON line feature in real-time. The sample includes data loaded from a CSV file, which is sorted and plotted sequentially to show the line’s movement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/world/animated_line_data.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">df_sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df_sample</span><span class="p">)]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df_sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]}}</span>
    <span class="p">],</span>
<span class="p">}</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">geojson</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;line-animation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-cap&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="s2">&quot;line-join&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">},</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#ed6498&quot;</span><span class="p">,</span> <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;line-opacity&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_times</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">run_times</span><span class="p">):</span>
    <span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_sample</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
        <span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">geojson</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/LRwfBl9.png" /></p>
</section>
<section id="animating-the-map-camera-around-a-point">
<h3><span class="section-number">16.18.2. </span>Animating the Map Camera Around a Point<a class="headerlink" href="#animating-the-map-camera-around-a-point" title="Link to this heading">#</a></h3>
<p>Control the map camera’s rotation, zoom, and angle around a given point to create a smooth animation effect. This technique is especially useful for visualizing cityscapes or other 3D environments by making buildings appear dynamic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">87.62712</span><span class="p">,</span> <span class="mf">41.89033</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">layers</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_style_layers</span><span class="p">()</span>
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">layer</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;symbol&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;text-field&quot;</span> <span class="ow">in</span> <span class="n">layer</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]):</span>
        <span class="n">m</span><span class="o">.</span><span class="n">remove_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3d-buildings&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source-layer&quot;</span><span class="p">:</span> <span class="s2">&quot;building&quot;</span><span class="p">,</span>
    <span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="s2">&quot;extrude&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">],</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fill-extrusion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;min_zoom&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;fill-extrusion-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#aaa&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill-extrusion-height&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span>
            <span class="mi">15</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mf">15.05</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-base&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;interpolate&quot;</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;zoom&quot;</span><span class="p">],</span>
            <span class="mi">15</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mf">15.05</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;min_height&quot;</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="s2">&quot;fill-extrusion-opacity&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/odCwtjT.png" /></p>
</section>
<section id="animating-a-point">
<h3><span class="section-number">16.18.3. </span>Animating a Point<a class="headerlink" href="#animating-a-point" title="Link to this heading">#</a></h3>
<p>Animate a point along a circular path by computing points on a circle and updating the map. This is ideal for showing circular motion on the map, and can be customized for duration and frame rate to control the animation speed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">degree</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">m</span><span class="o">.</span><span class="n">rotate_to</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">point_on_circle</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
        <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span><span class="p">],</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;liberty&quot;</span><span class="p">)</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">point_on_circle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">radius</span><span class="p">)}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;circle-radius&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;circle-color&quot;</span><span class="p">:</span> <span class="s2">&quot;#007cbf&quot;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">animate_marker</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">frame_rate</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># Convert to milliseconds</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># Divisor controls the animation speed</span>
        <span class="n">point</span> <span class="o">=</span> <span class="n">point_on_circle</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
        <span class="c1"># Wait for the next frame</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">frame_rate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">duration</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Duration of the animation in seconds</span>
<span class="n">frame_rate</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># Frames per second</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">animate_marker</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">frame_rate</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/EAxNQx4.png" /></p>
</section>
<section id="animating-a-point-along-a-route">
<h3><span class="section-number">16.18.4. </span>Animating a Point Along a Route<a class="headerlink" href="#animating-a-point-along-a-route" title="Link to this heading">#</a></h3>
<p>Create a point that follows a route specified by GeoJSON coordinates. For added realism, include rotation properties to simulate the direction of movement along the path. This animation is useful for tracking paths, such as vehicle or drone routes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;streets&quot;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/opengeos/datasets/releases/download/us/arc_with_bearings.geojson&quot;</span>
<span class="n">geojson</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">read_geojson</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">bearings</span> <span class="o">=</span> <span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;bearings&quot;</span><span class="p">]</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="n">geojson</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_geojson</span><span class="p">(</span><span class="n">geojson</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;route&quot;</span><span class="p">)</span>

<span class="n">origin</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">122.414</span><span class="p">,</span> <span class="mf">37.776</span><span class="p">]</span>
<span class="n">destination</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">77.032</span><span class="p">,</span> <span class="mf">38.913</span><span class="p">]</span>

<span class="n">point</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
    <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="n">origin</span><span class="p">},</span>
        <span class="p">}</span>
    <span class="p">],</span>
<span class="p">}</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">point</span><span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;icon-image&quot;</span><span class="p">:</span> <span class="s2">&quot;airport_15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon-rotate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;bearing&quot;</span><span class="p">],</span>
        <span class="s2">&quot;icon-rotation-alignment&quot;</span><span class="p">:</span> <span class="s2">&quot;map&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon-overlap&quot;</span><span class="p">:</span> <span class="s2">&quot;always&quot;</span><span class="p">,</span>
        <span class="s2">&quot;icon-ignore-placement&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">coordinate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
    <span class="n">point</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinate</span>
    <span class="n">point</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="s2">&quot;bearing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bearings</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="https://i.imgur.com/kdP1oT1.png" /></p>
</section>
<section id="updating-a-feature-in-real-time">
<h3><span class="section-number">16.18.5. </span>Updating a Feature in Real-Time<a class="headerlink" href="#updating-a-feature-in-real-time" title="Link to this heading">#</a></h3>
<p>For applications such as tracking or tracing a path in real time, load data from a source like GeoDataFrame, append coordinates incrementally to a line feature, and update the map display as the path extends.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.019807</span><span class="p">,</span> <span class="mf">45.632433</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-terrain&quot;</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://maplibre.org/maplibre-gl-js/docs/assets/hike.geojson&quot;</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;geojson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]]},</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<span class="n">layer</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;trace&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;trace&quot;</span><span class="p">,</span>
    <span class="s2">&quot;paint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;line-color&quot;</span><span class="p">:</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;line-opacity&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s2">&quot;line-width&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">jump_to</span><span class="p">({</span><span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;zoom&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_pitch</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
    <span class="n">source</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="s2">&quot;geometry&quot;</span><span class="p">][</span><span class="s2">&quot;coordinates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">pan_to</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="to-html">
<h2><span class="section-number">16.19. </span>To HTML<a class="headerlink" href="#to-html" title="Link to this heading">#</a></h2>
<p>Export the final map to HTML using the <code class="docutils literal notranslate"><span class="pre">to_html</span></code> method. This allows you to share interactive maps online while keeping your private API keys secure. Create public API keys restricted to your website’s domain for safety. Customize the HTML output, including dimensions, title, and embedding options.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import os</span>
<span class="c1"># os.environ[&quot;MAPTILER_KEY&quot;] = &quot;YOUR_PRIVATE_API_KEY&quot;</span>
<span class="c1"># os.environ[&quot;MAPTILER_KEY_PUBLIC&quot;] = &quot;YOUR_PUBLIC_API_KEY&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">122.19861</span><span class="p">,</span> <span class="mf">46.21168</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;3d-terrain&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">(</span><span class="n">bg_layers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span>
    <span class="s2">&quot;terrain.html&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Awesome 3D Map&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
    <span class="n">replace_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">leafmap</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">74.0066</span><span class="p">,</span> <span class="mf">40.7135</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=-</span><span class="mi">17</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;basic-v2&quot;</span>
<span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="s2">&quot;Esri.WorldImagery&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_3d_buildings</span><span class="p">(</span><span class="n">min_zoom</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">add_layer_control</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span>
    <span class="s2">&quot;buildings.html&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Awesome 3D Map&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
    <span class="n">replace_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="summary">
<h2><span class="section-number">16.20. </span>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this lecture, we explored the functionality of the MapLibre library for creating and customizing interactive maps in Python. We covered how to build a map from scratch, add controls, and manage different basemaps. Additionally, we explored more complex visualizations, including 3D building and terrain views, layer customization, and data integration with GeoJSON and raster formats. By understanding and applying these techniques, students are now equipped to develop dynamic geospatial visualizations using MapLibre, enhancing both analytical and presentation capabilities in their GIS projects.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "giswqs/geog-312",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./book/geospatial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="whitebox.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Whitebox</p>
      </div>
    </a>
    <a class="right-next"
       href="geemap.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">17. </span>Geemap</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">16.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-outcomes">16.2. Learning Outcomes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-resources">16.3. Useful Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-and-setup">16.4. Installation and Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-interactive-maps">16.5. Creating Interactive Maps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-map-setup">16.5.1. Basic Map Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-map-s-center-and-zoom-level">16.5.2. Customizing the Map’s Center and Zoom Level</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-basemap-style">16.5.3. Choosing a Basemap Style</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-background-colors">16.5.4. Adding Background Colors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-map-controls">16.6. Adding Map Controls</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-controls">16.6.1. Available Controls</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-geolocate-control">16.6.2. Adding Geolocate Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-fullscreen-control">16.6.3. Adding Fullscreen Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-navigation-control">16.6.4. Adding Navigation Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-draw-control">16.6.5. Adding Draw Control</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-layers">16.7. Adding Layers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-basemaps">16.7.1. Adding Basemaps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-xyz-tile-layer">16.7.2. Adding XYZ Tile Layer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-wms-layer">16.7.3. Adding WMS Layer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-raster-tiles">16.7.4. Adding Raster Tiles</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maptiler">16.8. MapTiler</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-vector-tile-source">16.8.1. Adding a vector tile source</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-mapping">16.9. 3D Mapping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-terrain">16.9.1. 3D Terrain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-buildings">16.9.2. 3D Buildings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-indoor-mapping">16.9.3. 3D Indoor Mapping</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-choropleth-map">16.9.4. 3D Choropleth Map</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-vector-data">16.10. Visualizing Vector Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#point-data">16.10.1. Point Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-marker-icon-image">16.10.2. Customizing Marker Icon Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-data">16.10.3. Line Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polygon-data">16.10.4. Polygon Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-geometries">16.10.5. Multiple Geometries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#marker-cluster">16.10.6. Marker Cluster</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-vector-data">16.10.7. Local Vector Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-building-color">16.10.8. Changing Building Color</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-new-layer-below-labels">16.10.9. Adding a New Layer Below Labels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-map">16.10.10. Heat Map</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-population-density">16.10.11. Visualizing Population Density</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-raster-data">16.11. Visualizing Raster Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-raster-data">16.11.1. Local Raster Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cloud-optimized-geotiff-cog">16.11.2. Cloud Optimized GeoTIFF (COG)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stac-layer">16.11.3. STAC Layer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interacting-with-the-map">16.12. Interacting with the Map</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-a-non-interactive-map">16.12.1. Displaying a Non-Interactive Map</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disabling-scroll-zoom">16.12.2. Disabling Scroll Zoom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-bounds">16.12.3. Fitting Bounds</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restricting-map-panning-to-an-area">16.12.4. Restricting Map Panning to an Area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flying-to">16.12.5. Flying To</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jumping-to-a-series-of-locations">16.12.6. Jumping to a Series of Locations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-coordinates-of-the-mouse-pointer">16.12.7. Getting Coordinates of the Mouse Pointer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-layer-styles">16.13. Customizing Layer Styles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-layer-color">16.13.1. Changing Layer Color</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-case-of-labels">16.13.2. Changing Case of Labels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-label-placement">16.13.3. Variable Label Placement</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-custom-components">16.14. Adding Custom Components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-image">16.14.1. Adding Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-text">16.14.2. Adding Text</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-gif">16.14.3. Adding GIF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-html">16.14.4. Adding HTML</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-color-bar">16.14.5. Adding Color bar</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-legend">16.14.6. Adding Legend</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-video">16.14.7. Adding Video</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pmtiles">16.15. PMTiles</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#protomaps-sample-data">16.15.1. Protomaps Sample Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-cooperative-data">16.15.2. Source Cooperative Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-pmtiles">16.15.3. 3D PMTiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">16.15.4. 3D Buildings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-buildings-transportation-and-other-themes">16.15.5. 2D Buildings, Transportation, and Other Themes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deck-gl-layers">16.16. Deck.GL Layers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-deck-gl-layer">16.16.1. Single Deck.GL Layer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-deck-gl-layers">16.16.2. Multiple Deck.GL Layers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#google-earth-engine">16.17. Google Earth Engine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animations">16.18. Animations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-a-line">16.18.1. Animating a Line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-the-map-camera-around-a-point">16.18.2. Animating the Map Camera Around a Point</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-a-point">16.18.3. Animating a Point</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-a-point-along-a-route">16.18.4. Animating a Point Along a Route</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#updating-a-feature-in-real-time">16.18.5. Updating a Feature in Real-Time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-html">16.19. To HTML</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">16.20. Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Qiusheng Wu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>