Traceback (most recent call last):
  File "/home/runner/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/runner/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/.local/share/uv/python/cpython-3.12.6-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/runner/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/runner/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
url = "https://opengeos.org/data/pmtiles/protomaps_firenze.pmtiles"
metadata = leafmap.pmtiles_metadata(url)
print(f"layer names: {metadata['layer_names']}")
print(f"bounds: {metadata['bounds']}")
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mIndexError[0m                                Traceback (most recent call last)
Cell [0;32mIn[42], line 2[0m
[1;32m      1[0m url [38;5;241m=[39m [38;5;124m"[39m[38;5;124mhttps://opengeos.org/data/pmtiles/protomaps_firenze.pmtiles[39m[38;5;124m"[39m
[0;32m----> 2[0m metadata [38;5;241m=[39m [43mleafmap[49m[38;5;241;43m.[39;49m[43mpmtiles_metadata[49m[43m([49m[43murl[49m[43m)[49m
[1;32m      3[0m [38;5;28mprint[39m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mlayer names: [39m[38;5;132;01m{[39;00mmetadata[[38;5;124m'[39m[38;5;124mlayer_names[39m[38;5;124m'[39m][38;5;132;01m}[39;00m[38;5;124m"[39m)
[1;32m      4[0m [38;5;28mprint[39m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mbounds: [39m[38;5;132;01m{[39;00mmetadata[[38;5;124m'[39m[38;5;124mbounds[39m[38;5;124m'[39m][38;5;132;01m}[39;00m[38;5;124m"[39m)

File [0;32m~/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/leafmap/common.py:11640[0m, in [0;36mpmtiles_metadata[0;34m(input_file)[0m
[1;32m  11637[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m urlparse(input_file)[38;5;241m.[39mpath[38;5;241m.[39mendswith([38;5;124m"[39m[38;5;124m.pmtiles[39m[38;5;124m"[39m):
[1;32m  11638[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m"[39m[38;5;124mInput file must be a .pmtiles file.[39m[38;5;124m"[39m)
[0;32m> 11640[0m header [38;5;241m=[39m [43mpmtiles_header[49m[43m([49m[43minput_file[49m[43m)[49m
[1;32m  11641[0m metadata_offset [38;5;241m=[39m header[[38;5;124m"[39m[38;5;124mmetadata_offset[39m[38;5;124m"[39m]
[1;32m  11642[0m metadata_length [38;5;241m=[39m header[[38;5;124m"[39m[38;5;124mmetadata_length[39m[38;5;124m"[39m]

File [0;32m~/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/leafmap/common.py:11575[0m, in [0;36mpmtiles_header[0;34m(input_file)[0m
[1;32m  11573[0m     headers [38;5;241m=[39m {[38;5;124m"[39m[38;5;124mRange[39m[38;5;124m"[39m: [38;5;124m"[39m[38;5;124mbytes=0-127[39m[38;5;124m"[39m}
[1;32m  11574[0m     response [38;5;241m=[39m requests[38;5;241m.[39mget(input_file, headers[38;5;241m=[39mheaders)
[0;32m> 11575[0m     header [38;5;241m=[39m [43mdeserialize_header[49m[43m([49m[43mresponse[49m[38;5;241;43m.[39;49m[43mcontent[49m[43m)[49m
[1;32m  11577[0m [38;5;28;01melse[39;00m:
[1;32m  11578[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m os[38;5;241m.[39mpath[38;5;241m.[39mexists(input_file):

File [0;32m~/work/geog-312/geog-312/.venv/lib/python3.12/site-packages/pmtiles/tile.py:254[0m, in [0;36mdeserialize_header[0;34m(buf)[0m
[1;32m    228[0m [38;5;28;01mdef[39;00m [38;5;21mread_int32[39m(pos):
[1;32m    229[0m     [38;5;28;01mreturn[39;00m [38;5;28mint[39m[38;5;241m.[39mfrom_bytes(buf[pos : pos [38;5;241m+[39m [38;5;241m4[39m], byteorder[38;5;241m=[39m[38;5;124m"[39m[38;5;124mlittle[39m[38;5;124m"[39m, signed[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[1;32m    231[0m [38;5;28;01mreturn[39;00m {
[1;32m    232[0m     [38;5;124m"[39m[38;5;124mversion[39m[38;5;124m"[39m: buf[[38;5;241m7[39m],
[1;32m    233[0m     [38;5;124m"[39m[38;5;124mroot_offset[39m[38;5;124m"[39m: read_uint64([38;5;241m8[39m),
[1;32m    234[0m     [38;5;124m"[39m[38;5;124mroot_length[39m[38;5;124m"[39m: read_uint64([38;5;241m16[39m),
[1;32m    235[0m     [38;5;124m"[39m[38;5;124mmetadata_offset[39m[38;5;124m"[39m: read_uint64([38;5;241m24[39m),
[1;32m    236[0m     [38;5;124m"[39m[38;5;124mmetadata_length[39m[38;5;124m"[39m: read_uint64([38;5;241m32[39m),
[1;32m    237[0m     [38;5;124m"[39m[38;5;124mleaf_directory_offset[39m[38;5;124m"[39m: read_uint64([38;5;241m40[39m),
[1;32m    238[0m     [38;5;124m"[39m[38;5;124mleaf_directory_length[39m[38;5;124m"[39m: read_uint64([38;5;241m48[39m),
[1;32m    239[0m     [38;5;124m"[39m[38;5;124mtile_data_offset[39m[38;5;124m"[39m: read_uint64([38;5;241m56[39m),
[1;32m    240[0m     [38;5;124m"[39m[38;5;124mtile_data_length[39m[38;5;124m"[39m: read_uint64([38;5;241m64[39m),
[1;32m    241[0m     [38;5;124m"[39m[38;5;124maddressed_tiles_count[39m[38;5;124m"[39m: read_uint64([38;5;241m72[39m),
[1;32m    242[0m     [38;5;124m"[39m[38;5;124mtile_entries_count[39m[38;5;124m"[39m: read_uint64([38;5;241m80[39m),
[1;32m    243[0m     [38;5;124m"[39m[38;5;124mtile_contents_count[39m[38;5;124m"[39m: read_uint64([38;5;241m88[39m),
[1;32m    244[0m     [38;5;124m"[39m[38;5;124mclustered[39m[38;5;124m"[39m: buf[[38;5;241m96[39m] [38;5;241m==[39m [38;5;241m0x1[39m,
[1;32m    245[0m     [38;5;124m"[39m[38;5;124minternal_compression[39m[38;5;124m"[39m: Compression(buf[[38;5;241m97[39m]),
[1;32m    246[0m     [38;5;124m"[39m[38;5;124mtile_compression[39m[38;5;124m"[39m: Compression(buf[[38;5;241m98[39m]),
[1;32m    247[0m     [38;5;124m"[39m[38;5;124mtile_type[39m[38;5;124m"[39m: TileType(buf[[38;5;241m99[39m]),
[1;32m    248[0m     [38;5;124m"[39m[38;5;124mmin_zoom[39m[38;5;124m"[39m: buf[[38;5;241m100[39m],
[1;32m    249[0m     [38;5;124m"[39m[38;5;124mmax_zoom[39m[38;5;124m"[39m: buf[[38;5;241m101[39m],
[1;32m    250[0m     [38;5;124m"[39m[38;5;124mmin_lon_e7[39m[38;5;124m"[39m: read_int32([38;5;241m102[39m),
[1;32m    251[0m     [38;5;124m"[39m[38;5;124mmin_lat_e7[39m[38;5;124m"[39m: read_int32([38;5;241m106[39m),
[1;32m    252[0m     [38;5;124m"[39m[38;5;124mmax_lon_e7[39m[38;5;124m"[39m: read_int32([38;5;241m110[39m),
[1;32m    253[0m     [38;5;124m"[39m[38;5;124mmax_lat_e7[39m[38;5;124m"[39m: read_int32([38;5;241m114[39m),
[0;32m--> 254[0m     [38;5;124m"[39m[38;5;124mcenter_zoom[39m[38;5;124m"[39m: [43mbuf[49m[43m[[49m[38;5;241;43m118[39;49m[43m][49m,
[1;32m    255[0m     [38;5;124m"[39m[38;5;124mcenter_lon_e7[39m[38;5;124m"[39m: read_int32([38;5;241m119[39m),
[1;32m    256[0m     [38;5;124m"[39m[38;5;124mcenter_lat_e7[39m[38;5;124m"[39m: read_int32([38;5;241m123[39m),
[1;32m    257[0m }

[0;31mIndexError[0m: index out of range

